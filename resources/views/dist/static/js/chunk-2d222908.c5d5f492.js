(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d222908"],{cec3:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{attrs:{width:"90%","close-on-click-modal":!1,visible:e.open,title:e.title},on:{"update:visible":function(t){e.open=t},close:e.closeDialog}},[r("el-card",{staticClass:"box-card"},[r("el-form",{attrs:{"label-width":"500px","label-position":"left"}},[r("el-form-item",{attrs:{label:e.$t("索引名称：")}},[r("el-input",{attrs:{placeholder:e.$t("索引名称"),disabled:"add"!=e.settingsType},model:{value:e.indexName,callback:function(t){e.indexName=t},expression:"indexName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"number_of_shards (分片数)："}},[r("el-input",{staticStyle:{width:"300px"},attrs:{type:"number",disabled:e.isOpen},model:{value:e.form.number_of_shards,callback:function(t){e.$set(e.form,"number_of_shards",t)},expression:"form.number_of_shards"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"number_of_replicas (副本数)："}},[r("el-input",{staticStyle:{width:"300px"},attrs:{type:"number"},model:{value:e.form.number_of_replicas,callback:function(t){e.$set(e.form,"number_of_replicas",t)},expression:"form.number_of_replicas"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"refresh_interval (索引的刷新时间间隔)："}},[r("el-input",{attrs:{placeholder:e.$t("索引的刷新时间间隔")},model:{value:e.form.refresh_interval,callback:function(t){e.$set(e.form,"refresh_interval",t)},expression:"form.refresh_interval"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"max_result_window  (from+size 的最大值)："}},[r("el-input",{staticStyle:{width:"300px"},attrs:{type:"number"},model:{value:e.form["index.max_result_window"],callback:function(t){e.$set(e.form,"index.max_result_window",t)},expression:"form['index.max_result_window']"}})],1)],1),e._v(" "),r("div",{staticStyle:{"text-align":"right"}},[r("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-close"},on:{click:e.closeDialog}},[e._v(e._s(e.$t("取消"))+"\n        ")]),e._v(" "),r("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-check"},on:{click:e.confirmSettings}},[e._v(e._s(e.$t("确认"))+"\n        ")])],1)],1)],1)],1)},s=[],a=(r("9f60"),r("94f0"),r("0c84"),r("2843"),r("a450"),r("4057"),r("b89e")),i=r("ed08");function o(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=l(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,s=function(){};return{s:s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){o=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(o)throw a}}}}function l(e,t){if(e){if("string"===typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var c={name:"Add",components:{},props:{indexName:{type:String,default:""},settingsType:{type:String,default:"add"},open:{type:Boolean,default:!1}},data:function(){return{staticConfig:["number_of_shards","index.translog.sync_interval","index.shard.check_on_startup","index.routing_partition_size","index.codec"],isOpen:!1,form:{"index.shard.check_on_startup":"","index.routing_partition_size":"","index.codec":"","index.auto_expand_replicas":"","index.max_result_window":"","index.max_rescore_window":"","index.blocks.read_only":"","index.blocks.read":"","index.blocks.write":"","index.blocks.metadata":"","index.blocks.read_only_allow_delete":"","index.max_refresh_listeners":"",number_of_shards:"",number_of_replicas:"",refresh_interval:"","index.translog.sync_interval":"","index.translog.durability":"","index.translog.flush_threshold_size":"","index.merge.scheduler.max_thread_count":"","index.merge.policy.max_merged_segment":"","index.merge.policy.segments_per_tier":""},dialogVisible:!0}},computed:{isStatic:function(){return"add"==this.settingsType||(this.open=!1)},title:function(){return"add"==this.settingsType?this.$t("新增索引配置"):this.$t("修改索引配置")}},created:function(){""!=this.indexName&&(this.catIndexStatus(),this.catIndexSettings())},methods:{confirmSettings:function(){var e=this,t=this.form;if(t["index.routing_partition_size"]>=t["index.number_of_shards"])this.$message({type:"error",message:"自定义路由值可以转发的目的分片数 必须小于 主分片数"});else if(""!=this.indexName){var r={};if(r["es_connect"]=this.$store.state.baseData.EsConnectID,r["settings"]=Object(i["b"])(this.form),r["index_name"]=this.indexName,r["types"]=this.settingsType,"update"==this.settingsType){var n,s=o(this.staticConfig);try{for(s.s();!(n=s.n()).done;){var l=n.value;delete r["settings"][l]}}catch(_){s.e(_)}finally{s.f()}}for(var d in r["settings"]){var c=r["settings"][d];""==c&&delete r["settings"][d]}var m=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(a["b"])(r).then((function(t){0==t.code||200==t.code?(e.$message({type:"success",message:t.msg}),e.settingsType="update",e.$emit("finished")):e.$message({type:"error",message:t.msg}),m.close()})).catch((function(e){m.close()}))}else this.$message({type:"error",message:"索引名不能为空"})},catIndexSettings:function(){var e=this,t={};t["es_connect"]=this.$store.state.baseData.EsConnectID,t["index_name"]=this.indexName,Object(a["e"])(t).then((function(t){if(0==t.code||200==t.code){var r=t.data["index"];if(e.form.number_of_replicas=r["number_of_replicas"],e.form.number_of_shards=r["number_of_shards"],r.hasOwnProperty("auto_expand_replicas")&&(e.form["index.auto_expand_replicas"]=r["auto_expand_replicas"]),r.hasOwnProperty("blocks")){var n=r["blocks"];n.hasOwnProperty("metadata")&&(e.form["index.blocks.metadata"]=n["metadata"]),n.hasOwnProperty("read")&&(e.form["index.blocks.read"]=n["read"]),n.hasOwnProperty("read_only")&&(e.form["index.blocks.read_only"]=n["read_only"]),n.hasOwnProperty("read_only_allow_delete")&&(e.form["index.blocks.read_only_allow_delete"]=n["read_only_allow_delete"]),n.hasOwnProperty("write")&&(e.form["index.blocks.write"]=n["write"])}if(r.hasOwnProperty("merge")){var s=r["merge"];if(s.hasOwnProperty("policy")){var a=s["policy"];a.hasOwnProperty("max_merged_segment")&&(e.form["index.merge.policy.max_merged_segment"]=a["max_merged_segment"]),a.hasOwnProperty("max_merged_segment")&&(e.form["index.merge.policy.segments_per_tier"]=a["segments_per_tier"])}if(s.hasOwnProperty("scheduler")){var i=s["scheduler"];i.hasOwnProperty("max_thread_count")&&(e.form["index.merge.scheduler.max_thread_count"]=i["max_thread_count"])}}if(r.hasOwnProperty("max_refresh_listeners")&&(e.form["index.max_refresh_listeners"]=r["max_refresh_listeners"]),r.hasOwnProperty("max_rescore_window")&&(e.form["index.max_rescore_window"]=r["max_rescore_window"]),r.hasOwnProperty("max_result_window")&&(e.form["index.max_result_window"]=r["max_result_window"]),r.hasOwnProperty("refresh_interval")&&(e.form["refresh_interval"]=r["refresh_interval"]),r.hasOwnProperty("translog")){var o=r["translog"];o.hasOwnProperty("durability")&&(e.form["index.translog.durability"]=o["durability"]),o.hasOwnProperty("flush_threshold_size")&&(e.form["index.translog.flush_threshold_size"]=o["flush_threshold_size"])}console.log(e.form,"form")}else e.$message({type:"error",message:t.msg})})).catch((function(e){console.log(e)}))},catIndexStatus:function(){var e=this,t={};t["es_connect"]=this.$store.state.baseData.EsConnectID,t["index_name"]=this.indexName,Object(a["a"])(t).then((function(t){0==t.code||200==t.code?(console.log(t),e.isOpen="open"==t.data[0].status):e.$message({type:"error",message:t.msg})})).catch((function(e){console.error(e)}))},closeDialog:function(){this.$emit("close")}}},m=c,_=r("cba8"),f=Object(_["a"])(m,n,s,!1,null,"0af9dd7a",null);t["default"]=f.exports}}]);