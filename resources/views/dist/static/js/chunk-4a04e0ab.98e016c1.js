(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4a04e0ab"],{"596d":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{"close-on-click-modal":!1,visible:e.open,title:e.$t("恢复备份")},on:{"update:visible":function(t){e.open=t},close:e.closeDialog}},[a("el-card",{staticClass:"box-card"},[a("el-form",{attrs:{"label-width":"500px","label-position":"left"}},[a("el-form-item",{attrs:{label:e.$t("仓库名")}},[a("el-input",{attrs:{readonly:""},model:{value:e.repository,callback:function(t){e.repository=t},expression:"repository"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("快照名")}},[a("el-input",{attrs:{readonly:""},model:{value:e.snapshot,callback:function(t){e.snapshot=t},expression:"snapshot"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("需要备份的索引")}},[a("index-select",{attrs:{multiple:!0,"have-all":!0,clearable:!0,placeholder:e.$t("迁移别名到多个索引上")},on:{change:e.changeIndex}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("rename_pattern 【正则表达式】")}},[a("el-input",{model:{value:e.form.rename_pattern,callback:function(t){e.$set(e.form,"rename_pattern",t)},expression:"form.rename_pattern"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("rename_replacement 【正则表达式】")}},[a("el-input",{model:{value:e.form.rename_replacement,callback:function(t){e.$set(e.form,"rename_replacement",t)},expression:"form.rename_replacement"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("ignore_unavailable   【把这个选项设置为 true 的时候在创建快照的过程中会忽略不存在的索引,如果没有设置ignore_unavailable，在索引不存在的情况下快照请求将会失败。】")}},[a("el-select",{attrs:{filterable:""},model:{value:e.form.ignore_unavailable,callback:function(t){e.$set(e.form,"ignore_unavailable",t)},expression:"form.ignore_unavailable"}},[a("el-option",{attrs:{label:e.$t("不设置"),value:null}}),e._v(" "),a("el-option",{attrs:{label:e.$t("是"),value:!0}}),e._v(" "),a("el-option",{attrs:{label:e.$t("否"),value:!1}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("include_global_state 【通过设置 include_global_state 为false 能够防止 集群的全局状态被作为快照的一部分存储起来】")}},[a("el-select",{attrs:{filterable:""},model:{value:e.form.include_global_state,callback:function(t){e.$set(e.form,"include_global_state",t)},expression:"form.include_global_state"}},[a("el-option",{attrs:{label:e.$t("不设置"),value:null}}),e._v(" "),a("el-option",{attrs:{label:e.$t("是"),value:!0}}),e._v(" "),a("el-option",{attrs:{label:e.$t("否"),value:!1}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("partial  【如果快照中的1个或多个索引不是全部主分片都可用，就会导致整个创建快照的过程失败。 通过设置 partial 为 true 可以改变这个行为】")}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.form.partial,callback:function(t){e.$set(e.form,"partial",t)},expression:"form.partial"}},[a("el-option",{attrs:{label:e.$t("不设置"),value:null}}),e._v(" "),a("el-option",{attrs:{label:e.$t("是"),value:!0}}),e._v(" "),a("el-option",{attrs:{label:e.$t("否"),value:!1}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("创建方式")}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.form.wait,callback:function(t){e.$set(e.form,"wait",t)},expression:"form.wait"}},[a("el-option",{attrs:{label:e.$t("不设置"),value:null}}),e._v(" "),a("el-option",{attrs:{label:e.$t("异步创建"),value:!0}}),e._v(" "),a("el-option",{attrs:{label:e.$t("同步创建"),value:!1}})],1)],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-close"},on:{click:e.closeDialog}},[e._v(e._s(e.$t("取消"))+"\n        ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-check"},on:{click:e.confirm}},[e._v(e._s(e.$t("确认"))+"\n        ")])],1)],1)],1)],1)},l=[],r=(a("e186"),a("c3ae")),o=a("344f"),i=a("cee7"),s={name:"Add",components:{IndexSelect:function(){return a.e("chunk-6e9d0f88").then(a.bind(null,"1ef5"))}},props:{open:{type:Boolean,default:!1},snapshot:{type:String,default:""},repository:{type:String,default:""}},data:function(){return{isOpen:!1,form:{snapshotName:this.snapshot,repositoryName:this.repository,ignore_unavailable:null,include_global_state:null,partial:null,wait:null,indexList:[],rename_pattern:"",rename_replacement:""}}},computed:{},created:function(){},methods:{changeIndex:function(e){this.form.indexList=[],this.form.indexList=e},closeDialog:function(){this.$emit("close",!1)},confirm:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,n,l,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.form,t["es_connect"]=this.$store.state.baseData.EsConnectID,e.next=4,Object(o["i"])(t);case 4:if(a=e.sent,n=a.code,a.data,l=a.msg,0!=n){e.next=12;break}return this.$emit("close",!0),this.$message({type:"success",message:l}),e.abrupt("return");case 12:-1!==l.indexOf(" with same name already exists ")?this.$confirm("错误信息:【"+l+"】,是否先关闭所有索引再进行恢复快照?","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={},t["es_connect"]=s.$store.state.baseData.EsConnectID,t["index_name"]="*",t["command"]="close",e.next=6,Object(i["b"])(t);case 6:if(a=e.sent,0==a.code){e.next=10;break}return s.$message({type:"error",message:l}),e.abrupt("return");case 10:s.confirm();case 11:case"end":return e.stop()}}),e)})))).catch((function(e){console.error(e)})):this.$message({type:"error",message:l});case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},c=s,u=a("cba8"),m=Object(u["a"])(c,n,l,!1,null,"4c239983",null);t["default"]=m.exports},cee7:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return i})),a.d(t,"f",(function(){return s})),a.d(t,"b",(function(){return c})),a.d(t,"d",(function(){return u}));var n=a("b775"),l="/api/es/";function r(e){return Object(n["a"])({url:l+"PingAction",method:"post",data:e})}function o(e){return Object(n["a"])({url:l+"CatAction",method:"post",data:e})}function i(e){return Object(n["a"])({url:l+"RunDslAction",method:"post",transformResponse:[function(e){return jsonlint.parse(e)}],data:e})}function s(e){return Object(n["a"])({url:l+"SqlToDslAction",method:"get",params:e})}function c(e){return Object(n["a"])({url:l+"OptimizeAction",method:"post",transformResponse:[function(e){return jsonlint.parse(e)}],data:e})}function u(e){return Object(n["a"])({url:l+"RecoverCanWrite",method:"post",data:e})}}}]);