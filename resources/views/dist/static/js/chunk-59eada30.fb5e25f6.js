(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59eada30"],{"344f":function(t,e,n){"use strict";n.d(e,"g",(function(){return s})),n.d(e,"h",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"e",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return l})),n.d(e,"d",(function(){return p})),n.d(e,"f",(function(){return h})),n.d(e,"i",(function(){return d})),n.d(e,"j",(function(){return f}));var r=n("b775"),a="/api/backUp/";function s(t){return Object(r["a"])({url:a+"SnapshotListAction",method:"post",data:t})}function o(t){return Object(r["a"])({url:a+"SnapshotRepositoryListAction",method:"post",data:t})}function i(t){return Object(r["a"])({url:a+"SnapshotCreateRepositoryAction",method:"post",data:t})}function c(t){return Object(r["a"])({url:a+"SnapshotDeleteRepositoryAction",method:"post",data:t})}function u(t){return Object(r["a"])({url:a+"CleanupeRepositoryAction",method:"post",data:t})}function l(t){return Object(r["a"])({url:a+"CreateSnapshotAction",method:"post",data:t})}function p(t){return Object(r["a"])({url:a+"SnapshotDeleteAction",method:"post",data:t})}function h(t){return Object(r["a"])({url:a+"SnapshotDetailAction",method:"post",data:t})}function d(t){return Object(r["a"])({url:a+"SnapshotRestoreAction",method:"post",data:t})}function f(t){return Object(r["a"])({url:a+"SnapshotStatusAction",method:"post",data:t})}},bef7:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"filter-container"},[n("el-select",{attrs:{clearable:"",filterable:"",placeholder:t.$t("请选择存储库"),loading:t.loading},on:{change:t.search},model:{value:t.repositoryName,callback:function(e){t.repositoryName=e},expression:"repositoryName"}},t._l(t.resData,(function(t,e,r){return n("el-option",{key:r,attrs:{label:e,value:e}})})),1),t._v(" "),n("el-button",{attrs:{size:"mini",type:"warning"},nativeOn:{click:function(e){t.openAddDialog=!0}}},[t._v(t._s(t.$t("新建快照"))+"\n    ")]),t._v(" "),n("el-button",{attrs:{size:"mini",type:"success"},on:{click:t.search}},[t._v(t._s(t.$t("刷新"))+"\n    ")])],1),t._v(" "),n("el-table",{attrs:{data:t.tableData}},[n("el-table-column",{attrs:{label:t.$t("序号"),align:"center",fixed:"",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.$index+1)+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("快照名"),prop:"id",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("备份索引数"),prop:"indices",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("状态"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return["SUCCESS"==e.row.status?n("el-tag",{attrs:{type:"success"}},[t._v(t._s(t.$t("成功")))]):"IN_PROGRESS"==e.row.status?n("el-tag",{attrs:{type:"warning"}},[t._v(t._s(t.$t("还在进行中")))]):n("el-tag",[t._v(t._s(e.row.status))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("开始详细时间"),width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[t._v(t._s(t.timestampToTime(e.row.start_epoch)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("结束详细时间"),width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[t._v(t._s(t.timestampToTime(e.row.end_epoch)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("耗费时长"),prop:"duration",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("分片总数"),prop:"total_shards",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("成功分片数"),prop:"successful_shards",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("失败分片数"),prop:"failed_shards",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("操作"),fixed:"right",width:"350"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button-group",[n("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-search"},on:{click:function(n){return t.look(e.row.id)}}},[t._v(t._s(t.$t("查看"))+"\n          ")]),t._v(" "),n("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(n){return t.SnapshotDeleteAction(e.row.id)}}},[t._v(t._s(t.$t("删除"))+"\n          ")]),t._v(" "),n("el-button",{attrs:{type:"warning",size:"mini",icon:"el-icon-refresh"},on:{click:function(n){return t.openRestore(e.row.id)}}},[t._v(t._s(t.$t("恢复"))+"\n          ")]),t._v(" "),n("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-refresh"},on:{click:function(n){return t.status(e.row.id)}}},[t._v(t._s(t.$t("状态"))+"\n          ")])],1)]}}])})],1),t._v(" "),n("el-drawer",{ref:"drawer",attrs:{title:t.$t("快照详细信息"),"before-close":t.drawerHandleClose,visible:t.drawerShow,direction:"rtl","close-on-press-escape":"","destroy-on-close":"",size:"50%"},on:{"update:visible":function(e){t.drawerShow=e}}},[n("json-editor",{staticClass:"res-body",attrs:{styles:"width: 100%",read:!0,title:t.$t("快照详细信息")},model:{value:JSON.stringify(t.snapshotDetail,null,"\t"),callback:function(e){t.$set(JSON,"stringify(snapshotDetail,null, '\t')",e)},expression:"JSON.stringify(snapshotDetail,null, '\\t')"}})],1),t._v(" "),t.openAddDialog?n("add",{attrs:{open:t.openAddDialog},on:{close:t.closeAddDialog}}):t._e(),t._v(" "),t.openRestoreDialog?n("snapshot-restore",{attrs:{repository:t.repositoryName,snapshot:t.name,open:t.openRestoreDialog},on:{close:t.closeoRestoreDialog}}):t._e()],1)},a=[],s=(n("a450"),n("1bc7"),n("32ea"),n("d91d"),n("e186"),n("c3ae")),o=n("344f");function i(t){var e=new Date(1e3*t),n=e.getFullYear()+"-",r=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-",a=c(e.getDate())+" ",s=c(e.getHours())+":",o=c(e.getMinutes())+":",i=c(e.getSeconds());return n+r+a+s+o+i}function c(t){return t<10?"0"+t:t}var u={name:"ResTable",components:{JsonEditor:function(){return Promise.all([n.e("chunk-31af6a17"),n.e("chunk-03b113fc"),n.e("chunk-36ba3740")]).then(n.bind(null,"fa7e"))},Add:function(){return n.e("chunk-2d0c80bf").then(n.bind(null,"52e1"))},SnapshotRestore:function(){return n.e("chunk-4a04e0ab").then(n.bind(null,"596d"))}},data:function(){return{openRestoreDialog:!1,openAddDialog:!1,loading:!1,repositoryName:"",resData:{},name:"",drawerShow:!1,tableData:[],index:0,tableHeader:[],snapshotDetail:""}},created:function(){this.initRepositoryName()},methods:{status:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={},n["es_connect"]=this.$store.state.baseData.EsConnectID,n["snapshot"]=e,n["repository"]=this.repositoryName,t.next=6,Object(o["j"])(n);case 6:if(r=t.sent,a=r.data,s=r.code,i=r.msg,0==s){t.next=15;break}return this.$message({type:"error",message:i}),t.abrupt("return");case 15:return this.snapshotDetail=a.snapshots,this.drawerShow=!0,this.$message({type:"success",message:i}),t.abrupt("return");case 19:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),openRestore:function(t){this.name=t,this.openRestoreDialog=!0},timestampToTime:function(t){return i(t)},SnapshotDeleteAction:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={},n["es_connect"]=this.$store.state.baseData.EsConnectID,n["snapshot"]=e,n["repository"]=this.repositoryName,t.next=6,Object(o["d"])(n);case 6:if(r=t.sent,r.data,a=r.code,s=r.msg,0==a){t.next=15;break}return this.$message({type:"error",message:s}),t.abrupt("return");case 15:return this.initRepositoryName(),this.search(),this.$message({type:"success",message:s}),t.abrupt("return");case 19:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),closeoRestoreDialog:function(t){this.openRestoreDialog=!1,t&&(this.initRepositoryName(),this.search())},closeAddDialog:function(t){this.openAddDialog=!1,t&&(this.initRepositoryName(),this.search())},initRepositoryName:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n,r,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={},e["es_connect"]=this.$store.state.baseData.EsConnectID,t.next=5,Object(o["h"])(e);case 5:if(n=t.sent,r=n.data,a=n.code,s=n.msg,0!=a){t.next=15;break}this.resData=r.res,Object.keys(this.resData).length>0&&(this.repositoryName=Object.keys(this.resData)[0]),this.search(),t.next=22;break;case 15:if(199999!=a){t.next=20;break}return this.$notify({title:"Error",dangerouslyUseHTMLString:!0,message:'\n<strong>\n            <i style="color: orange">path.repo没有设置</i><br>\n<i>在elasticsearch.yml 配置文件中配置仓库base目录</i><br>\n<i>添加path.repo: /tmp/tmp (/tmp/tmp 为快照备份所在文件夹, <br><i style="color: orange">注意</i>首先要先创建这个文件夹)</i>\n\n          ',type:"error"}),t.abrupt("return");case 20:return this.$message({type:"error",message:s}),t.abrupt("return");case 22:this.loading=!1;case 23:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),search:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n,r,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={},e["es_connect"]=this.$store.state.baseData.EsConnectID,e["repository"]=this.repositoryName,t.next=5,Object(o["g"])(e);case 5:if(n=t.sent,r=n.data,a=n.code,s=n.msg,0==a){t.next=14;break}return this.$message({type:"error",message:s}),t.abrupt("return");case 14:this.$message({type:"success",message:s}),this.tableData=r;case 16:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),openDetail:function(t,e,n){this.name=t.name,this.drawerShow=!0},look:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.name=e,n={},n["es_connect"]=this.$store.state.baseData.EsConnectID,n["repository"]=this.repositoryName,n["snapshot"]=e,t.next=7,Object(o["f"])(n);case 7:if(r=t.sent,a=r.data,s=r.code,i=r.msg,0==s){t.next=16;break}return this.$message({type:"error",message:i}),t.abrupt("return");case 16:this.snapshotDetail=a.snapshots,this.drawerShow=!0;case 18:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),drawerHandleClose:function(t){t()}}},l=u,p=n("cba8"),h=Object(p["a"])(l,r,a,!1,null,"b2b002c4",null);e["default"]=h.exports}}]);