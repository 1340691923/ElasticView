(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a8ac04a"],{5766:function(e,t,r){},6665:function(e,t,r){},"80e2":function(e,t,r){"use strict";r("6665")},d78e:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",{staticClass:"filter-container"},[r("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:e.handleAddRole}},[e._v(e._s(e.$t("新建角色"))+"\n    ")])],1),e._v(" "),r("el-table",{attrs:{data:e.rolesList},on:{"row-dblclick":e.handleEdit}},[r("el-table-column",{attrs:{label:e.$t("序号"),align:"center",fixed:"",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.$index+1)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:e.$t("角色id"),width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.id)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:e.$t("角色名"),width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.name)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"header-center",label:e.$t("角色详细信息")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.description)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:e.$t("操作"),width:"220",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(r){return r.stopPropagation(),e.handleEdit(t.row)}}},[e._v(e._s(e.$t("编辑"))+"\n        ")]),e._v(" "),r("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(r){return r.stopPropagation(),e.handleDelete(t)}}},[e._v(e._s(e.$t("删除"))+"\n        ")])]}}])})],1),e._v(" "),r("el-dialog",{attrs:{"close-on-click-modal":!1,width:"70%",visible:e.dialogVisible,title:"edit"===e.dialogType?e.$t("修改角色"):e.$t("新建角色")},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{attrs:{model:e.role,"label-width":"120px","label-position":"left"}},[r("el-form-item",{attrs:{label:e.$t("角色名")}},[r("el-input",{attrs:{placeholder:e.$t("角色名")},model:{value:e.role.name,callback:function(t){e.$set(e.role,"name",t)},expression:"role.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:e.$t("角色详情信息")}},[r("el-input",{attrs:{autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:e.$t("角色详情信息")},model:{value:e.role.description,callback:function(t){e.$set(e.role,"description",t)},expression:"role.description"}})],1),e._v(" "),r("el-form-item",{attrs:{label:e.$t("菜单栏")}},[r("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:e.$t("输入关键字进行过滤")},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),r("el-button",{attrs:{size:"mini",icon:"el-icon-check"},on:{click:e.quanxuan}},[e._v(e._s(e.$t("全选"))+"\n        ")]),e._v(" "),r("el-tree",{ref:"tree",staticClass:"permission-tree",attrs:{"filter-node-method":e.filterNode,"check-strictly":e.checkStrictly,data:e.routesData,props:e.defaultProps,"show-checkbox":"","node-key":"path"}})],1),e._v(" "),1!=e.role.id?r("el-form-item",{attrs:{label:e.$t("接口权限设置")}},[e.dialogVisible?r("el-transfer",{attrs:{titles:[e.$t("全部接口权限"),e.$t("角色拥有权限")],"button-texts":[e.$t("移除权限"),e.$t("添加权限")],filterable:"","filter-method":e.filterMethod,"filter-placeholder":e.$t("请选择接口名"),data:e.allApiConfig},model:{value:e.role.api,callback:function(t){e.$set(e.role,"api",t)},expression:"role.api"}}):e._e()],1):e._e()],1),e._v(" "),r("div",{staticStyle:{"text-align":"right"}},[r("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-close"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(e._s(e.$t("取消"))+"\n      ")]),e._v(" "),r("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-check"},on:{click:e.confirmRole}},[e._v(e._s(e.$t("确定"))+"\n      ")])],1)],1)],1)},i=[],o=(r("ac67"),r("32ea"),r("9f60"),r("94f0"),r("0c84"),r("2843"),r("4057"),r("1554")),a=(r("a450"),r("aa18"),r("982e"),r("0871")),l=(r("1bc7"),r("e186"),r("c3ae")),s=r("6266"),c=r.n(s),u=r("ed08"),d=r("e370"),h=r("b775");function f(){return Object(h["a"])({url:"/api/gm_user/roles",method:"get"})}function p(e){return Object(h["a"])({url:"/api/gm_user/role/add",method:"post",data:e})}function g(e){return Object(h["a"])({url:"/api/gm_user/role/update",method:"post",data:e})}function b(e){return Object(h["a"])({url:"/api/gm_user/role/delete",method:"get",params:e})}var v="/api/gm_user/";function m(e){return Object(h["a"])({url:v+"UrlConfig",method:"get",params:e})}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=k(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw o}}}}function k(e,t){if(e){if("string"===typeof e)return $(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$(e,t):void 0}}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var O={id:"",name:"",description:"",routes:[],api:[]},x={data:function(){return{allApiConfig:[],value:[],filterMethod:function(e,t){return t.label.indexOf(e)>-1},urlConfig:[],urlConfigMap:[],filterText:"",role:Object.assign({},O),routes:[],rolesList:[],dialogVisible:!1,dialogType:"new",checkStrictly:!1,defaultProps:{children:"children",label:"title"},chanCfgList:[]}},computed:{routesData:function(){return this.routes}},watch:{filterText:function(e){this.$refs["tree"].filter(e)}},created:function(){this.getUrlOpt(),this.getRoutes(),this.getRoles()},methods:{getUrlOpt:function(){var e=this;m().then((function(t){if(t){var r,n=_(t.data);try{for(n.s();!(r=n.n()).done;){var i=r.value,o=i["url"],a=i["remark"];e.allApiConfig.push({label:a,key:o,disabled:!1})}}catch(l){n.e(l)}finally{n.f()}}}))},quanxuan:function(){this.$refs.tree.setCheckedNodes(this.routes)},getRoutes:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=d["b"],this.serviceRoutes=t,this.routes=this.generateRoutes(t);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getRoles:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:for(r in t=e.sent,t.data)console.log(t.data[r]),t.data[r]["routes"]=JSON.parse(t.data[r]["routes"]);this.rolesList=t.data;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),generateRoutes:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",n=[],i=_(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(!o.hidden||o.service){var a=this.onlyOneShowingChild(o.children,o);o.children&&a&&!o.alwaysShow&&(o=a);var l={path:c.a.resolve(r,o.path),title:o.meta&&o.meta.title};o.children&&(l.children=this.generateRoutes(o.children,l.path)),n.push(l)}}}catch(s){i.e(s)}finally{i.f()}return n},generateArr:function(e){var t=this,r=[];return e.forEach((function(e){if(r.push(e),e.children){var n=t.generateArr(e.children);n.length>0&&(r=[].concat(Object(a["a"])(r),Object(a["a"])(n)))}})),r},filterNode:function(e,t){return!e||-1!==t.title.indexOf(e)},handleAddRole:function(){this.role=Object.assign({},O),this.$refs.tree&&this.$refs.tree.setCheckedNodes([]),this.dialogType="new",this.dialogVisible=!0},handleEdit:function(e){var t=this;console.log(e,"row"),this.dialogType="edit",this.dialogVisible=!0,this.checkStrictly=!0,this.role=Object(u["c"])(e),this.$nextTick((function(){var e=t.generateRoutes(t.role.routes);t.$refs.tree.setCheckedNodes(t.generateArr(e)),t.checkStrictly=!1}))},handleDelete:function(e){var t=this,r=e.$index,n=e.row;this.$confirm(this.$t("确定删除这个角色吗?"),this.$t("警告"),{confirmButtonText:this.$t("确定"),cancelButtonText:this.$t("取消"),type:"warning"}).then(Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b({id:n.id});case 2:t.rolesList.splice(r,1),t.$message({type:"success",message:"Delete succed!"});case 4:case"end":return e.stop()}}),e)})))).catch((function(e){console.error(e)}))},generateTree:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",n=arguments.length>2?arguments[2]:void 0,i=[],o=_(e);try{for(o.s();!(t=o.n()).done;){var a=t.value,l=c.a.resolve(r,a.path);a.children&&(a.children=this.generateTree(a.children,l,n)),(n.includes(l)||a.children&&a.children.length>=1)&&i.push(a)}}catch(s){o.e(s)}finally{o.f()}return i},confirmRole:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,r,n,i,o,a,l,s,c,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t="edit"===this.dialogType,r=this.$refs.tree.getCheckedKeys(),this.role.routes=this.generateTree(Object(u["c"])(this.serviceRoutes),"/",r),n=this.role,n.routes=JSON.stringify(n.routes),!t){e.next=19;break}return n["id"]=this.role.id,e.next=9,g(n);case 9:i=0;case 10:if(!(i<this.rolesList.length)){e.next=17;break}if(this.rolesList[i].id!==this.role.id){e.next=14;break}return this.rolesList.splice(i,1,Object.assign({},this.role)),e.abrupt("break",17);case 14:i++,e.next=10;break;case 17:e.next=26;break;case 19:return n.id=0,e.next=22,p(n);case 22:o=e.sent,a=o.data,this.role.id=a.id,this.rolesList.push(this.role);case 26:l=this.role,s=l.description,c=l.id,d=l.name,this.dialogVisible=!1,this.$notify({title:"Success",dangerouslyUseHTMLString:!0,message:"\n            <div>id: ".concat(c,"</div>\n            <div>Role Name: ").concat(d,"</div>\n            <div>Description: ").concat(s,"</div>\n          "),type:"success"});case 29:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onlyOneShowingChild:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=null,n=e.filter((function(e){return!e.hidden}));return 1===n.length?(r=n[0],r.path=c.a.resolve(t.path,r.path),r):0===n.length&&(r=w(w({},t),{},{path:"",noShowingChildren:!0}),r)}}},j=x,S=(r("d7fa"),r("80e2"),r("cba8")),R=Object(S["a"])(j,n,i,!1,null,"b1cc195c",null);t["default"]=R.exports},d7fa:function(e,t,r){"use strict";r("5766")}}]);