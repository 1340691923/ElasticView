(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d216b44"],{c430:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"filter-container"},[n("el-select",{attrs:{"reserve-keyword":"","collapse-tags":"",placeholder:t.$t("行为"),clearable:"",multiple:"",filterable:""},on:{change:function(e){return t.searchByFilter()}},model:{value:t.input.actions,callback:function(e){t.$set(t.input,"actions",e)},expression:"input.actions"}},t._l(t.actions,(function(t,e){return n("el-option",{key:e,attrs:{label:t,value:t}})})),1),t._v(" "),n("el-select",{attrs:{"reserve-keyword":"","collapse-tags":"",placeholder:t.$t("任务ID"),clearable:"",multiple:"",clearable:"",filterable:""},on:{change:function(e){return t.searchByFilter()}},model:{value:t.input.task_id,callback:function(e){t.$set(t.input,"task_id",e)},expression:"input.task_id"}},t._l(t.taskIdList,(function(t,e){return n("el-option",{key:e,attrs:{label:t,value:t}})})),1),t._v(" "),n("el-select",{attrs:{"reserve-keyword":"","collapse-tags":"",placeholder:t.$t("节点ID"),clearable:"",multiple:"",clearable:"",filterable:""},on:{change:function(e){return t.searchByFilter()}},model:{value:t.input.node_id,callback:function(e){t.$set(t.input,"node_id",e)},expression:"input.node_id"}},t._l(t.nodeIdList,(function(t,e){return n("el-option",{key:e,attrs:{label:t,value:t}})})),1),t._v(" "),n("el-select",{attrs:{placeholder:t.$t("父任务ID"),clearable:"",clearable:"",filterable:""},on:{change:function(e){return t.searchByFilter()}},model:{value:t.input.parent_task_id,callback:function(e){t.$set(t.input,"parent_task_id",e)},expression:"input.parent_task_id"}},t._l(t.parentTaskIdList,(function(t,e){return n("el-option",{key:e,attrs:{label:t,value:t}})})),1),t._v(" "),n("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.search(!0)}}},[t._v(t._s(t.$t("搜索"))+"\n    ")]),t._v(" "),n("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-refresh"},on:{click:t.refresh}},[t._v(t._s(t.$t("刷新"))+"\n    ")])],1),t._v(" "),n("el-table",{attrs:{data:t.tableData}},[n("el-table-column",{attrs:{label:t.$t("序号"),align:"center",fixed:"",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.$index+1)+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("行为"),prop:"action",width:"200"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("任务详细ID"),prop:"taskID",width:"300"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("任务ID"),prop:"id",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("节点"),prop:"node",width:"200"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("父任务ID"),prop:"parent_task_id",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[t._v(t._s(e.row.parent_task_id))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("开始详细时间"),width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[t._v(t._s(t.timestampToTime(e.row.start_time_in_millis)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("状态"),width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-popover",{attrs:{placement:"top-start",title:t.$t("描述"),width:"600",trigger:"hover"}},[n("div",[t._v(t._s(JSON.stringify(e.row.status)))]),t._v(" "),n("span",{attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(JSON.stringify(e.row.status).substr(0,50)+"..."))])])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("运行时间（秒）"),width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[t._v(t._s(Number(e.row.running_time_in_nanos/1e9)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("是否可撤销"),prop:"cancellable",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[t._v(t._s(e.row.cancellable))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("描述"),prop:"description",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-popover",{attrs:{placement:"top-start",title:t.$t("描述"),width:"600",trigger:"hover"}},[n("div",[t._v(t._s(e.row.description))]),t._v(" "),n("span",{attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(e.row.description.substr(0,50)+"..."))])])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("开始时间"),prop:"start_time",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("开始时间（毫秒）"),prop:"start_time_in_millis",width:"150"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("类型"),prop:"type",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:t.$t("操作"),fixed:"right",width:"350"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button-group",[n("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-search"},on:{click:function(n){return t.look(e.row)}}},[t._v(t._s(t.$t("查看"))+"\n          ")]),t._v(" "),n("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(n){return t.CancelAction(e.row.taskID)}}},[t._v(t._s(t.$t("取消"))+"\n          ")])],1)]}}])})],1),t._v(" "),n("el-drawer",{ref:"drawer",attrs:{title:t.$t("任务详细信息"),"before-close":t.drawerHandleClose,visible:t.drawerShow,direction:"rtl","close-on-press-escape":"","destroy-on-close":"",size:"50%"},on:{"update:visible":function(e){t.drawerShow=e}}},[n("json-editor",{attrs:{styles:"width: 100%",read:!0,title:t.$t("任务详细信息")},model:{value:t.taskDetail,callback:function(e){t.taskDetail=e},expression:"taskDetail"}})],1)],1)},a=[],i=(n("9f60"),n("94f0"),n("a450"),n("4057"),n("2843"),n("1bc7"),n("0c84"),n("c5cb"),n("e186"),n("c3ae")),s=(n("d91d"),n("f19b")),l=n.n(s),o=n("b775"),c="/api/es_task/";function u(t){return Object(o["a"])({url:c+"ListAction",method:"post",data:t})}function d(t){return Object(o["a"])({url:c+"CancelAction",method:"post",data:t})}function p(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=f(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw i}}}}function f(t,e){if(t){if("string"===typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var _={name:"ResTable",components:{JsonEditor:function(){return Promise.all([n.e("chunk-31af6a17"),n.e("chunk-03b113fc"),n.e("chunk-36ba3740")]).then(n.bind(null,"fa7e"))},Add:function(){return n.e("chunk-5bf85f5a").then(n.bind(null,"52e1"))},SnapshotRestore:function(){return n.e("chunk-40711a49").then(n.bind(null,"596d"))}},data:function(){return{taskDetail:"",loading:!1,drawerShow:!1,tableData:[],taskIdList:[],parentTaskIdList:[],nodeIdList:[],actions:[],input:{task_id:[],node_id:[],parent_task_id:"",actions:[]}}},created:function(){this.search()},methods:{inArray:function(t,e){for(var n in e)if(e[n]==t)return!0;return!1},searchByFilter:function(){var t=[],e=!1;if(""!=this.input.parent_task_id){e=!0;var n,r=p(this.tableData);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.parent_task_id==this.input.parent_task_id&&t.push(a)}}catch(_){r.e(_)}finally{r.f()}}if(this.input.actions.length>0){e=!0;var i,s=p(this.tableData);try{for(s.s();!(i=s.n()).done;){var l=i.value;this.inArray(l.action,this.input.actions)&&t.push(l)}}catch(_){s.e(_)}finally{s.f()}}if(this.input.node_id.length>0){e=!0;var o,c=p(this.tableData);try{for(c.s();!(o=c.n()).done;){var u=o.value;this.inArray(u.node,this.input.node_id)&&t.push(u)}}catch(_){c.e(_)}finally{c.f()}}if(this.input.task_id.length>0){e=!0;var d,f=p(this.tableData);try{for(f.s();!(d=f.n()).done;){var h=d.value;this.inArray(h.taskID,this.input.task_id)&&t.push(h)}}catch(_){f.e(_)}finally{f.f()}}1==e?this.tableData=t:(console.log(11),this.search())},CancelAction:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={},n["es_connect"]=this.$store.state.baseData.EsConnectID,n["task_id"]=e,t.next=5,d(n);case 5:if(r=t.sent,r.data,a=r.code,i=r.msg,0==a){t.next=14;break}return this.$message({type:"error",message:i}),t.abrupt("return");case 14:return this.search(),this.$message({type:"success",message:i}),t.abrupt("return");case 17:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),look:function(t){console.log(t),this.taskDetail=JSON.stringify(t,null,"\t"),this.drawerShow=!0},drawerHandleClose:function(t){t()},timestampToTime:function(t){var e=new Date(t),n=l()(e).format("YYYY-MM-DD HH:mm:ss");return n},search:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,i,s,l,o,c,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e&&(this.input={task_id:[],node_id:[],parent_task_id:"",actions:[]}),n={},n["es_connect"]=this.$store.state.baseData.EsConnectID,t.next=5,u(n);case 5:if(r=t.sent,a=r.data,i=r.code,s=r.msg,0==i){t.next=14;break}return this.$message({type:"error",message:s}),t.abrupt("return");case 14:for(c in this.$message({type:"success",message:s}),this.tableData=[],this.taskIdList=[],this.parentTaskIdList=[],this.nodeIdList=[],l=new Set,o=new Set,a)d=a[c],d["taskID"]=c,this.tableData.push(d),this.taskIdList.push(c),""!=d.parent_task_id&&this.parentTaskIdList.push(d.parent_task_id),l.add(d.node),o.add(d.action);this.nodeIdList=Array.from(l),this.actions=Array.from(o);case 24:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),refresh:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.search();case 2:this.searchByFilter();case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},b=_,v=n("cba8"),m=Object(v["a"])(b,r,a,!1,null,"3527b388",null);e["default"]=m.exports}}]);