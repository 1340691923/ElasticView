import{d as e,b as a,z as l,al as s,k as t,v as i,x as o,c as n,e as r,h as d,C as u,i as c,g as p,n as m,f as _,w as g,D as v,E as f,p as y,F as b,_ as h,q as w,H as k,aP as D,aU as j,r as V,J as x,l as C,a7 as K,b4 as z,a5 as E,a6 as U,a0 as S,aS as B,b5 as T,o as A,a9 as I,aI as R,d5 as $,d6 as O,a3 as P,S as M,V as F,d7 as H,d8 as J,d9 as L,j as q,c3 as G,b9 as X,aX as N}from"./index.W33FBolP.js";import{E as Q}from"./el-loading.DTgwG8UQ.js";import{E as W,a as Y}from"./el-tab-pane.DAaixt0V.js";import{E as Z}from"./el-pagination.CbGKzv28.js";/* empty css               */import{E as ee,a as ae}from"./el-select.D5pkIrdC.js";import"./el-scrollbar.CF952IsS.js";import{E as le}from"./el-tooltip.Dj6yvCEN.js";import{E as se}from"./el-card.CAShaOk8.js";import{a as te,E as ie}from"./el-form.yboLIzGg.js";import"./el-form-item.l0sNRNKZ.js";import{b as oe,U as ne,P as re,I as de,S as ue,c as ce}from"./plugins.Bmcidn9r.js";import{_ as pe}from"./index.B9Hb0hEi.js";import{E as me}from"./el-dialog.DytY6MIX.js";import{E as _e}from"./index.CwuhdP3B.js";import{_ as ge}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./use-dialog.Uu3kEZll.js";import"./isUndefined.DgmxjSXK.js";import"./strings.Dd75Su9I.js";import"./index.BlQRGALI.js";import"./_Uint8Array.DOwfnrpH.js";import"./refs.hX0BCaP6.js";const ve=e({name:"ElTimeline",setup(e,{slots:i}){const o=a("timeline");return l("timeline",i),()=>s("ul",{class:[o.b()]},[t(i,"default")])}}),fe=i({timestamp:{type:String,default:""},hideTimestamp:Boolean,center:Boolean,placement:{type:String,values:["top","bottom"],default:"bottom"},type:{type:String,values:["primary","success","warning","danger","info"],default:""},color:{type:String,default:""},size:{type:String,values:["normal","large"],default:"normal"},icon:{type:o},hollow:Boolean}),ye=e({name:"ElTimelineItem"});var be=h(e({...ye,props:fe,setup(e){const l=e,s=a("timeline-item"),i=n((()=>[s.e("node"),s.em("node",l.size||""),s.em("node",l.type||""),s.is("hollow",l.hollow)]));return(e,a)=>(r(),d("li",{class:c([p(s).b(),{[p(s).e("center")]:e.center}])},[u("div",{class:c(p(s).e("tail"))},null,2),e.$slots.dot?y("v-if",!0):(r(),d("div",{key:0,class:c(p(i)),style:m({backgroundColor:e.color})},[e.icon?(r(),_(p(f),{key:0,class:c(p(s).e("icon"))},{default:g((()=>[(r(),_(v(e.icon)))])),_:1},8,["class"])):y("v-if",!0)],6)),e.$slots.dot?(r(),d("div",{key:1,class:c(p(s).e("dot"))},[t(e.$slots,"dot")],2)):y("v-if",!0),u("div",{class:c(p(s).e("wrapper"))},[e.hideTimestamp||"top"!==e.placement?y("v-if",!0):(r(),d("div",{key:0,class:c([p(s).e("timestamp"),p(s).is("top")])},b(e.timestamp),3)),u("div",{class:c(p(s).e("content"))},[t(e.$slots,"default")],2),e.hideTimestamp||"bottom"!==e.placement?y("v-if",!0):(r(),d("div",{key:1,class:c([p(s).e("timestamp"),p(s).is("bottom")])},b(e.timestamp),3))],2)],2))}}),[["__file","timeline-item.vue"]]);const he=w(ve,{TimelineItem:be}),we=k(be),ke=u("div",{class:"hint"},"请前往 http://dev.elastic-view.cn 注册账户后拷贝evKey至此并保存",-1),De={slot:"footer",class:"dialog-footer"},je={__name:"index",props:{visible:{type:Boolean,default:!1}},emits:["update:visible"],setup(e,{emit:a}){const l=D(),s=n((()=>l.device===j.MOBILE)),t=e,i=a,o=V({evKey:""}),d=V(!1);x((()=>t.visible),(e=>{d.value=e}));const c=()=>{d.value=!1,i("update:visible",!1),o.value.evKey=""},m=async()=>{const e=o.value.evKey;if(!e)return void z.error("请填写 evKey");let a=await oe({ev_key:e});0==a.code?(z.success({type:"success",offset:60,message:"evKey导入成功，请重新进行想要进行的操作"}),c()):z.error({type:"error",offset:60,message:a.msg})};return(e,a)=>{const l=E,t=te,i=ie,n=U,v=me;return r(),_(v,{width:p(s)?"100%":"60vw",title:"请填写 evKey",modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=e=>d.value=e),onClose:c},{default:g((()=>[C(i,{model:o.value,ref:"formRef"},{default:g((()=>[C(t,{label:"evKey",prop:"evKey"},{default:g((()=>[C(l,{modelValue:o.value.evKey,"onUpdate:modelValue":a[0]||(a[0]=e=>o.value.evKey=e),placeholder:"请输入 evKey"},null,8,["modelValue"]),ke])),_:1})])),_:1},8,["model"]),u("span",De,[C(n,{onClick:c},{default:g((()=>[K("取消")])),_:1}),C(n,{type:"primary",onClick:m},{default:g((()=>[K("保存")])),_:1})])])),_:1},8,["width","modelValue"])}}},Ve={class:"app-container"},xe={class:"sort-wrapper"},Ce={class:"plugin-container"},Ke={class:"plugin-list"},ze={class:"plugin-header"},Ee=["src"],Ue={class:"plugin-title"},Se={class:"plugin-body"},Be={class:"plugin-description"},Te={class:"plugin-tags"},Ae={class:"plugin-stats"},Ie={class:"stat-item"},Re={class:"stat-item"},$e={class:"plugin-footer"},Oe={class:"publish-time"},Pe={class:"pagination-container"},Me={class:"plugin-detail"},Fe={class:"detail-header"},He={class:"header-main"},Je={class:"plugin-info"},Le=["src"],qe={class:"info-content"},Ge={class:"plugin-title"},Xe={class:"plugin-desc"},Ne={class:"tag-group"},Qe={class:"stats-group"},We={class:"stat-item"},Ye={class:"stat-item"},Ze={class:"stat-item"},ea={class:"readme-content"},aa={class:"version-list"},la={class:"version-header"},sa={class:"version-tag"},ta={class:"version-actions"},ia={class:"dialog-footer"},oa=ge(e({__name:"market",setup(e){const a=D(),l=n((()=>a.device===j.MOBILE)),s=S({visible:!1}),t=B(),i=V(!1),o=V(!1),m=S({count:0,list:[]}),h=S({count:0,list:[]}),w=V("readme");n((()=>({"plugin-box-black":t.theme===T.DARK,"plugin-box-light":t.theme!==T.DARK})));const k=S({search_txt:"",order_by_col:"star_cnt",order_by_desc:!0,has_download_type:null,page:1,limit:10}),x=S({pluginData:{id:0,plugin_alias:"",plugin_name:"",user_id:0,describe:"",plugin_lang:"",readme:"",create_time:"",update_time:"",state:2,logo:"",msg:"",download_cnt:0,star_cnt:0,download_user_cnt:0,buy_coin_num:0},publish_id:0,page:1,limit:10}),oe=V(!1),me=()=>{oe.value=!0};n((()=>t.theme===T.DARK?"rgb(24, 27, 31)":""));const ge=async()=>{be.value=!0;let e=await ne({plugin_id:x.pluginData.plugin_alias});be.value=!1,0==e.code?(x.pluginData.has_download=!1,z.success({type:"success",offset:60,message:e.msg})):z.error({type:"error",offset:60,message:e.msg})};n((()=>t.theme===T.DARK?"rgb(204, 204, 220)":"black")),n((()=>t.theme===T.DARK?"rgb(122,122,133)":"gray"));const ve=e=>{k.limit=e,ye()},fe=e=>{k.page=e,ye()},ye=async()=>{i.value=!0;const e=await re(k);i.value=!1,0==e.code?(m.count=e.data.count,m.list=e.data.list):z.error({type:"error",offset:60,message:e.msg})},be=V(!1),ke=async e=>{be.value=!0;let a=await de({plugin_id:x.pluginData.plugin_alias,version:e});var l;(be.value=!1,-1===a.msg.indexOf("请前往"))?0==a.code?(x.pluginData.has_download=!0,-1!==a.msg.indexOf("刷新")?await(l=x.pluginData.plugin_name,void N.confirm(l+"插件安裝成功,是否立即刷新页面?","是否刷新",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((async()=>{window.location.reload()})).catch((e=>{console.error(e)}))):z.success({type:"success",offset:60,message:a.msg})):z.error({type:"error",offset:60,message:a.msg}):me()},De=async()=>{o.value=!0;const e=await ce({page:x.page,limit:x.limit,plugin_id:x.pluginData.id});o.value=!1,0==e.code?(null==e.data.list&&(e.data.list=[]),h.count=e.data.count,h.list=e.data.list):z.error({type:"error",offset:60,message:e.msg})},oa=()=>{s.visible=!1},na=()=>{k.order_by_desc=!k.order_by_desc,ye()},ra=V(!1),da=()=>{ra.value=!ra.value};return A((()=>{ye()})),(e,a)=>{const o=f,n=U,D=E,j=te,V=ee,S=ae,B=ie,A=le,N=_e,ne=se,re=Z,de=W,ce=we,ua=he,ca=Y,pa=Q,ma=X;return r(),d("div",Ve,[p(l)?(r(),d("div",{key:0,class:"mobile-filter-toggle",onClick:da},[C(n,{type:"primary",class:"toggle-button"},{default:g((()=>[K(b(ra.value?"收起筛选":"展开筛选")+" ",1),C(o,{class:c(["toggle-icon",{"is-reverse":ra.value}])},{default:g((()=>[C(p(I))])),_:1},8,["class"])])),_:1})])):y("",!0),u("div",{class:c(["search-container",{"is-mobile":p(l),"is-collapsed":p(l)&&!ra.value}])},[C(B,{inline:!0,class:"search-form"},{default:g((()=>[C(j,{label:"插件名/描述:"},{default:g((()=>[C(D,{modelValue:p(k).search_txt,"onUpdate:modelValue":a[0]||(a[0]=e=>p(k).search_txt=e),clearable:"",placeholder:"搜索插件...",class:"custom-input"},{prefix:g((()=>[C(o,null,{default:g((()=>[C(p(R))])),_:1})])),_:1},8,["modelValue"])])),_:1}),C(j,{label:"排序:"},{default:g((()=>[u("div",xe,[C(S,{modelValue:p(k).order_by_col,"onUpdate:modelValue":a[1]||(a[1]=e=>p(k).order_by_col=e),class:"custom-select"},{default:g((()=>[C(V,{label:"star次数",value:"star_cnt"}),C(V,{label:"下载人数",value:"download_user_cnt"}),C(V,{label:"下载次数",value:"download_cnt"}),C(V,{label:"最后更新时间",value:"publish_time"})])),_:1},8,["modelValue"]),C(n,{size:"default",class:"sort-button",type:p(k).order_by_desc?"default":"primary",onClick:na},{default:g((()=>[C(o,null,{default:g((()=>[(r(),_(v(p(k).order_by_desc?p($):p(O))))])),_:1})])),_:1},8,["type"])])])),_:1}),C(j,{label:"安装状态:"},{default:g((()=>[C(S,{modelValue:p(k).has_download_type,"onUpdate:modelValue":a[2]||(a[2]=e=>p(k).has_download_type=e),class:"custom-select"},{default:g((()=>[C(V,{label:"全部",value:null}),C(V,{label:"未安装",value:!1}),C(V,{label:"已安装",value:!0})])),_:1},8,["modelValue"])])),_:1}),C(j,null,{default:g((()=>[C(n,{type:"primary",icon:p(R),class:"search-button",onClick:ye},{default:g((()=>[K(b(e.$t("搜索")),1)])),_:1},8,["icon"])])),_:1})])),_:1})],2),P((r(),d("div",Ce,[u("div",Ke,[(r(!0),d(M,null,F(p(m).list,((e,a)=>(r(),d("div",{key:e.id,class:"plugin-card-wrapper"},[C(ne,{class:c(["plugin-card",{"is-dark":p(t).theme===p(T).DARK}]),onClick:a=>(async e=>{x.pluginData=e,s.visible=!0,await De()})(e),"body-style":{padding:"0"}},{default:g((()=>[u("div",ze,[u("img",{src:e.logo,class:"plugin-logo",loading:"lazy"},null,8,Ee),u("h3",Ue,b(e.plugin_name),1)]),u("div",Se,[u("p",Be,[C(A,{content:e.describe,placement:"top"},{default:g((()=>{return[K(b((a=e.describe,l=50,a.length>l?a.slice(0,l)+"...":a)),1)];var a,l})),_:2},1032,["content"])]),u("div",Te,[e.has_download?(r(),_(N,{key:0,type:"success",effect:"light"},{default:g((()=>[K("已安装")])),_:1})):y("",!0),e.buy_coin_num>0?(r(),_(N,{key:1,type:"primary",effect:"light"},{default:g((()=>[K(" 所需ev币: "+b(e.buy_coin_num)+"个 ",1)])),_:2},1024)):(r(),_(N,{key:2,type:"info",effect:"light"},{default:g((()=>[K("免费")])),_:1}))]),u("div",Ae,[C(A,{content:"安装次数/人数",placement:"top"},{default:g((()=>[u("div",Ie,[C(o,null,{default:g((()=>[C(p(H))])),_:1}),K(" "+b(e.download_cnt)+"/"+b(e.download_user_cnt),1)])])),_:2},1024),C(A,{content:"Star数",placement:"top"},{default:g((()=>[u("div",Re,[C(o,null,{default:g((()=>[C(p(J))])),_:1}),K(" "+b(e.star_cnt),1)])])),_:2},1024)])]),u("div",$e,[u("span",Oe,b(e.publish_time),1),C(n,{type:1===e.star_state?"primary":"default",icon:1===e.star_state?p(L):p(J),circle:"",size:"small",onClick:q((l=>(async(e,a)=>{let l=await ue({plugin_id:e.id});if(0!=l.code)return-1!==l.msg.indexOf("请前往")?void me():void z.error({type:"error",offset:60,message:l.msg});let s="star成功";1==e.star_state?(s="取消star成功",m.list[a].star_state=2,m.list[a].star_cnt=m.list[a].star_cnt-1):(m.list[a].star_state=1,m.list[a].star_cnt=m.list[a].star_cnt+1),z.success({type:"success",offset:60,message:s})})(e,a)),["stop"])},null,8,["type","icon","onClick"])])])),_:2},1032,["class","onClick"])])))),128))])])),[[ma,i.value]]),u("div",Pe,[C(re,{"current-page":p(k).page,"onUpdate:currentPage":a[3]||(a[3]=e=>p(k).page=e),"page-size":p(k).limit,"onUpdate:pageSize":a[4]||(a[4]=e=>p(k).limit=e),total:p(m).count,"page-sizes":[10,20,30,50],background:"",layout:p(l)?"prev, pager, next":"total, sizes, prev, pager, next, jumper",onSizeChange:ve,onCurrentChange:fe},null,8,["current-page","page-size","total","layout"])]),C(pa,{modelValue:p(s).visible,"onUpdate:modelValue":a[7]||(a[7]=e=>p(s).visible=e),title:"插件详情",size:p(l)?"100%":"80%"},{footer:g((()=>[u("div",ia,[p(x).pluginData.has_download?y("",!0):(r(),_(n,{key:0,type:"primary",onClick:a[6]||(a[6]=e=>ke(p(h).list[0].version))},{default:g((()=>[K(" 安装最新版本 ")])),_:1})),p(x).pluginData.has_download?(r(),_(n,{key:1,type:"danger",onClick:ge},{default:g((()=>[K(" 卸载 ")])),_:1})):y("",!0),C(n,{onClick:oa},{default:g((()=>[K("取消")])),_:1})])])),default:g((()=>[u("div",Me,[P((r(),_(ne,{class:"detail-card"},{default:g((()=>[u("div",Fe,[u("div",He,[u("div",Je,[u("img",{src:p(x).pluginData.logo,class:"plugin-logo"},null,8,Le),u("div",qe,[u("h1",Ge,b(p(x).pluginData.plugin_name),1),u("p",Xe,b(p(x).pluginData.describe),1)])]),u("div",Ne,[p(x).pluginData.has_download?(r(),_(N,{key:0,type:"success"},{default:g((()=>[K("已安装")])),_:1})):y("",!0),C(N,null,{default:g((()=>[K("开发者: "+b(p(x).pluginData.realname),1)])),_:1}),C(N,{type:p(x).pluginData.buy_coin_num>0?"primary":"info"},{default:g((()=>[K(b(p(x).pluginData.buy_coin_num>0?`所需ev币: ${p(x).pluginData.buy_coin_num}个`:"免费"),1)])),_:1},8,["type"])]),u("div",Qe,[u("div",We,[C(o,null,{default:g((()=>[C(p(H))])),_:1}),u("span",null,"安装: "+b(p(x).pluginData.download_cnt)+"次/"+b(p(x).pluginData.download_user_cnt)+"人",1)]),u("div",Ye,[C(o,null,{default:g((()=>[C(p(J))])),_:1}),u("span",null,"Star: "+b(p(x).pluginData.star_cnt),1)]),u("div",Ze,[C(o,null,{default:g((()=>[C(p(G))])),_:1}),u("span",null,"更新时间: "+b(p(x).pluginData.publish_time),1)])])])]),C(ca,{modelValue:w.value,"onUpdate:modelValue":a[5]||(a[5]=e=>w.value=e),class:"detail-tabs"},{default:g((()=>[C(de,{label:"介绍",name:"readme"},{default:g((()=>[u("div",ea,[C(pe,{content:p(x).pluginData.readme},null,8,["content"])])])),_:1}),C(de,{label:"版本列表",name:"versions"},{default:g((()=>[u("div",aa,[C(ua,null,{default:g((()=>[(r(!0),d(M,null,F(p(h).list,((e,a)=>(r(),_(ce,{key:a,timestamp:e.update_time,placement:"top"},{default:g((()=>[C(ne,{class:"version-card"},{header:g((()=>[u("div",la,[u("span",sa,"v"+b(e.version),1),u("div",ta,[p(l)?y("",!0):(r(),_(N,{key:0,type:"warning",class:"version-support"},{default:g((()=>[K(" 最大支持ev版本: "+b(e.gte_ev_dependency_ver),1)])),_:2},1024)),p(l)?y("",!0):(r(),_(N,{key:1,type:"success",class:"version-support"},{default:g((()=>[K(" 最小支持ev版本: "+b(e.lte_ev_dependency_ver),1)])),_:2},1024)),C(n,{onClick:q((a=>ke(e.version)),["stop"]),type:"warning",icon:p(H),circle:""},null,8,["onClick","icon"])])])])),default:g((()=>[C(pe,{content:e.changelog,class:"changelog"},null,8,["content"])])),_:2},1024)])),_:2},1032,["timestamp"])))),128))])),_:1})])])),_:1})])),_:1},8,["modelValue"])])),_:1})),[[ma,be.value]])])])),_:1},8,["modelValue","size"]),C(je,{visible:oe.value,"onUpdate:visible":a[8]||(a[8]=e=>oe.value=e)},null,8,["visible"])])}}}),[["__scopeId","data-v-2dfb4984"]]);export{oa as default};
//# sourceMappingURL=market.BJ2chxVY.js.map
