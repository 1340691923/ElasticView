{"version":3,"file":"EsDashbord.vue_vue_type_script_setup_true_lang.2-raTYlL.js","sources":["../../../vue/src/views/dashboard/components/EsDashbord.vue"],"sourcesContent":["<!--  线 + 柱混合图 -->\n<template>\n  <el-row :gutter=\"10\" class=\"mt-5\">\n\n    <el-col :xs=\"24\" :sm=\"12\" :lg=\"6\">\n      <el-card>\n        <template #header>\n          <div class=\"flex-x-between\">\n              <span class=\"text-[var(--el-text-color-secondary)]\"\n              >总分片数</span\n              >\n            <el-tag type=\"primary\">{{articleData.count.allShared }}</el-tag>\n          </div>\n        </template>\n\n        <div\n          class=\"flex-x-between mt-2 text-sm text-[var(--el-text-color-secondary)]\"\n        >\n          <span> 主分片数 </span>\n          <el-tag type=\"success\">{{articleData.count.pri }}</el-tag>\n        </div>\n        <div\n          class=\"flex-x-between mt-2 text-sm text-[var(--el-text-color-secondary)]\"\n        >\n          <span> 未分配的分片数 </span>\n          <el-tag type=\"danger\">{{articleData.count.unassigned }}</el-tag>\n        </div>\n      </el-card>\n    </el-col>\n    <el-col :xs=\"24\" :sm=\"12\" :lg=\"6\">\n      <el-card>\n        <template #header>\n          <div class=\"flex-x-between\">\n              <span class=\"text-[var(--el-text-color-secondary)]\"\n              >索引数</span\n              >\n            <el-tag type=\"primary\">{{articleData.count.index}}</el-tag>\n          </div>\n        </template>\n\n        <div\n          class=\"flex-x-between mt-2 text-sm text-[var(--el-text-color-secondary)]\"\n        >\n          <span> 文档数 </span>\n          <el-tag type=\"success\">{{articleData.count.document}}</el-tag>\n        </div>\n        <div\n          class=\"flex-x-between mt-2 text-sm text-[var(--el-text-color-secondary)]\"\n        >\n          <span> 索引所占空间大小 </span>\n          <el-tag type=\"danger\">{{articleData.count.size}}</el-tag>\n        </div>\n      </el-card>\n    </el-col>\n\n  </el-row>\n</template>\n\n<script setup lang=\"ts\">\nimport {GetLocalPluginList, GetWxArticleList} from \"@/api/plugins\";\nimport {GetEsConnect} from \"@/utils/es_link\";\nimport {CatAction, IndexsCountAction} from \"@/api/es\";\n\nconst articleData = reactive({\n  count: {\n    allShared: 0,\n    successfulShared: 0,\n    index: 0,\n    pri:0,\n    unassigned:0,\n    document: 0,\n    size: 0\n  },\n})\n\nconst getIndexCount = async () =>{\n  const form = {\n    es_connect: GetEsConnect()\n  }\n\n  const { data, code, msg } = await IndexsCountAction(form)\n\n  if (code == 0) {\n    articleData.count.index = data\n  }\n\n}\n\nconst catAllocation = async () => {\n  const form = {\n    cat: 'CatAllocation',\n    es_connect: GetEsConnect()\n  }\n\n  const { data, code, msg } = await CatAction(form)\n\n  if (code == 0) {\n    articleData.count.size = data[0]['disk.indices']\n  }\n}\n\nconst catStats = async ()=> {\n  const form = {\n    cat: 'CatStats',\n    es_connect: GetEsConnect()\n  }\n\n  const { data, code, msg } = await CatAction(form)\n\n  if (code == 0) {\n    articleData.count.document = data.indices.docs.count\n  }\n}\n\nconst getSegments = async () =>{\n\n  const form = {\n    cat: 'CatHealth',\n    es_connect: GetEsConnect()\n  }\n\n  const { data, code, msg } = await CatAction(form)\n\n  if (code == 0) {\n    if(data.length >0){\n      let allShared = 0\n      let unassigned = 0\n      let pri = 0\n      for(let i in data){\n\n        let v = data[i]\n        pri = pri + Number(v.pri)\n        allShared = allShared + Number(v.shards)\n        unassigned = unassigned + Number(v.unassign)\n      }\n\n      articleData.count.unassigned = unassigned\n      articleData.count.allShared = allShared\n      articleData.count.pri = pri\n    }\n\n  }\n}\n\n\nonMounted(()=>{\n  getIndexCount()\n  catAllocation()\n  getSegments()\n  catStats()\n})\n</script>\n<style lang=\"scss\" scoped></style>\n"],"names":["articleData","reactive","count","allShared","successfulShared","index","pri","unassigned","document","size","onMounted","async","form","es_connect","GetEsConnect","data","code","msg","IndexsCountAction","cat","CatAction","length","i","v","Number","shards","unassign","indices","docs"],"mappings":"y9BA+DA,MAAMA,EAAcC,EAAS,CAC3BC,MAAO,CACLC,UAAW,EACXC,iBAAkB,EAClBC,MAAO,EACPC,IAAI,EACJC,WAAW,EACXC,SAAU,EACVC,KAAM,YA0EVC,GAAU,KAtEYC,WACpB,MAAMC,EAAO,CACXC,WAAYC,MAGRC,KAAEA,EAAMC,KAAAA,EAAAC,IAAMA,SAAcC,EAAkBN,GAExC,GAARI,IACFhB,EAAYE,MAAMG,MAAQU,EAC5B,KAIoBJ,WACpB,MAAMC,EAAO,CACXO,IAAK,gBACLN,WAAYC,MAGRC,KAAEA,EAAMC,KAAAA,EAAAC,IAAMA,SAAcG,EAAUR,GAEhC,GAARI,IACFhB,EAAYE,MAAMO,KAAOM,EAAK,GAAG,gBACnC,KAgBkBJ,WAElB,MAAMC,EAAO,CACXO,IAAK,YACLN,WAAYC,MAGRC,KAAEA,EAAMC,KAAAA,EAAAC,IAAMA,SAAcG,EAAUR,GAE5C,GAAY,GAARI,GACCD,EAAKM,OAAQ,EAAE,CAChB,IAAIlB,EAAY,EACZI,EAAa,EACbD,EAAM,EACV,IAAA,IAAQgB,KAAKP,EAAK,CAEZ,IAAAQ,EAAIR,EAAKO,GACPhB,GAAMkB,OAAOD,EAAEjB,KACTH,GAAYqB,OAAOD,EAAEE,QACpBlB,GAAaiB,OAAOD,EAAEG,SACrC,CAEA1B,EAAYE,MAAMK,WAAaA,EAC/BP,EAAYE,MAAMC,UAAYA,EAC9BH,EAAYE,MAAMI,IAAMA,CAC1B,CAEF,KAxCeK,WACf,MAAMC,EAAO,CACXO,IAAK,WACLN,WAAYC,MAGRC,KAAEA,EAAMC,KAAAA,EAAAC,IAAMA,SAAcG,EAAUR,GAEhC,GAARI,IACFhB,EAAYE,MAAMM,SAAWO,EAAKY,QAAQC,KAAK1B,MACjD"}