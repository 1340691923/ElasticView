import{d as e,r as l,a0 as a,o as t,au as o,bG as r,e as s,h as i,C as d,l as u,w as n,g as p,a4 as m,a7 as c,a3 as f,f as y,D as v,F as h,p as _,j as k,b9 as b,S as g,V,dY as w,aY as U,aP as j,a5 as N,a6 as C,E,bc as T}from"./index.DMBpWXpT.js";/* empty css                   */import{E as A}from"./el-drawer.CpqknkfB.js";import{_ as x}from"./index.OICg9GcR.js";import{E as O}from"./el-input-number.zcrW3MHJ.js";import"./el-tooltip.l0sNRNKZ.js";import{E as L}from"./el-popper.Cb3Eus9m.js";import{_ as M}from"./question-filled.8tGWrj00.js";import{E as P,a as I}from"./el-radio.B-TDguQR.js";/* empty css               */import"./el-select.C9ddzdnq.js";import"./el-scrollbar.BJ_tYB1D.js";import"./el-tree.UTBgh5GW.js";import"./el-checkbox.8MJHthul.js";import{E as q}from"./el-tree-select.BGIuc0mE.js";import{E as G}from"./el-card.BhvZLWwX.js";import{E as B,a as F}from"./el-table-column.Dl1jn1Bd.js";import{a as K,_ as R}from"./delete.CrlEmVes.js";import{_ as X}from"./index.DBfl569D.js";import{_ as z}from"./plus.BhbEy4-l.js";import{E as S,a as D}from"./el-form.DUR-mZNt.js";import{_ as W}from"./refresh.BxJIPU5v.js";import{_ as Y}from"./search.DdQbLJWh.js";import"./el-form-item.l0sNRNKZ.js";import{E as Q}from"./index.qeCV5ckY.js";import"./use-dialog.CoOh9qjD.js";import"./isUndefined.DgmxjSXK.js";import"./el-popover.OX4vypnS.js";import"./dropdown.Dka1h-m0.js";import"./el-tab-pane.Dc62g1GH.js";import"./strings.DeQ3Zoz4.js";import"./_plugin-vue_export-helper.BCo6x5W8.js";import"./index.tvUbLRs9.js";import"./token.DWNpOE8r.js";import"./isEqual.B61-3bNT.js";import"./_Uint8Array.BEOPqGcx.js";import"./debounce.l44evi-0.js";import"./index.CP01f_MK.js";import"./castArray.arHVDzqw.js";var $=(e=>(e.CATALOG="CATALOG",e.MENU="MENU",e.BUTTON="BUTTON",e.EXTLINK="EXTLINK",e))($||{});const H={class:"app-container"},J={class:"search-container"},Z={key:0},ee={key:1},le=d("span",{class:"mx-1"},"=",-1),ae=d("br",null,null,-1),te=d("br",null,null,-1),oe={class:"dialog-footer"},re=e({name:"Menu",inheritAttrs:!1,__name:"index",setup(e){const re=l(S),se=l(S),ie=l(!1),de=a({title:"新增菜单",visible:!1}),ue=a({}),ne=l([]),pe=l([]),me=l({id:void 0,parentId:0,visible:1,sort:1,type:$.MENU,alwaysShow:0,keepAlive:1,params:[]}),ce=l({...me.value}),fe=a({parentId:[{required:!0,message:"请选择顶级菜单",trigger:"blur"}],name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],type:[{required:!0,message:"请选择菜单类型",trigger:"blur"}],routeName:[{required:!0,message:"请输入路由名称",trigger:"blur"}],routePath:[{required:!0,message:"请输入路由路径",trigger:"blur"}],component:[{required:!0,message:"请输入组件路径",trigger:"blur"}],visible:[{required:!0,message:"请输入路由路径",trigger:"blur"}]}),ye=l();function ve(){ie.value=!0,w.getList(ue).then((e=>{ne.value=e})).finally((()=>{ie.value=!1}))}function he(){re.value.resetFields(),ve()}function _e(e){ye.value=e.id}function ke(e,l){w.getOptions().then((e=>{pe.value=[{value:0,label:"顶级菜单",children:e}]})).then((()=>{de.visible=!0,l?(de.title="编辑菜单",w.getFormData(l).then((e=>{me.value={...e},ce.value=e}))):(de.title="新增菜单",ce.value.parentId=e)}))}function be(){ce.value.type!==me.value.type&&ce.value.type===$.MENU&&(me.value.type===$.CATALOG?ce.value.component="":(ce.value.routePath=me.value.routePath,ce.value.component=me.value.component))}function ge(){se.value.validate((e=>{if(e){const e=ce.value.id;e?w.update(e,ce.value).then((()=>{U.success("修改成功"),Ve(),ve()})):w.add(ce.value).then((()=>{U.success("新增成功"),Ve(),ve()}))}}))}function Ve(){de.visible=!1,se.value.resetFields(),se.value.clearValidate(),ce.value.id=void 0}return t((()=>{ve()})),(e,l)=>{const a=N,t=D,me=Y,ye=C,we=W,Ue=S,je=z,Ne=E,Ce=X,Ee=B,Te=Q,Ae=K,xe=R,Oe=F,Le=G,Me=q,Pe=P,Ie=I,qe=M,Ge=L,Be=o("CirclePlusFilled"),Fe=o("DeleteFilled"),Ke=O,Re=x,Xe=A,ze=r("hasPerm"),Se=T;return s(),i("div",H,[d("div",J,[u(Ue,{ref_key:"queryFormRef",ref:re,model:p(ue),inline:!0},{default:n((()=>[u(t,{label:"关键字",prop:"keywords"},{default:n((()=>[u(a,{modelValue:p(ue).keywords,"onUpdate:modelValue":l[0]||(l[0]=e=>p(ue).keywords=e),placeholder:"菜单名称",clearable:"",onKeyup:m(ve,["enter"])},null,8,["modelValue"])])),_:1}),u(t,null,{default:n((()=>[u(ye,{type:"primary",onClick:ve},{icon:n((()=>[u(me)])),default:n((()=>[c("搜索")])),_:1}),u(ye,{onClick:he},{icon:n((()=>[u(we)])),default:n((()=>[c(" 重置")])),_:1})])),_:1})])),_:1},8,["model"])]),u(Le,{shadow:"never",class:"table-container"},{header:n((()=>[f((s(),y(ye,{type:"success",onClick:l[1]||(l[1]=e=>ke(0))},{icon:n((()=>[u(je)])),default:n((()=>[c(" 新增")])),_:1})),[[ze,["sys:menu:add"]]])])),default:n((()=>[f((s(),y(Oe,{data:p(ne),"highlight-current-row":"","row-key":"id","expand-row-keys":["1"],onRowClick:_e,"tree-props":{children:"children",hasChildren:"hasChildren"}},{default:n((()=>[u(Ee,{label:"菜单名称","min-width":"200"},{default:n((e=>[e.row.icon&&e.row.icon.startsWith("el-icon")?(s(),y(Ne,{key:0,style:{"vertical-align":"-0.15em"}},{default:n((()=>[(s(),y(v(e.row.icon.replace("el-icon-",""))))])),_:2},1024)):e.row.icon?(s(),y(Ce,{key:1,"icon-class":e.row.icon},null,8,["icon-class"])):(s(),y(Ce,{key:2,"icon-class":"menu"})),c(" "+h(e.row.name),1)])),_:1}),u(Ee,{label:"类型",align:"center",width:"80"},{default:n((e=>[e.row.type===p($).CATALOG?(s(),y(Te,{key:0,type:"warning"},{default:n((()=>[c("目录")])),_:1})):_("",!0),e.row.type===p($).MENU?(s(),y(Te,{key:1,type:"success"},{default:n((()=>[c("菜单")])),_:1})):_("",!0),e.row.type===p($).BUTTON?(s(),y(Te,{key:2,type:"danger"},{default:n((()=>[c("按钮")])),_:1})):_("",!0),e.row.type===p($).EXTLINK?(s(),y(Te,{key:3,type:"info"},{default:n((()=>[c("外链")])),_:1})):_("",!0)])),_:1}),u(Ee,{label:"路由名称",align:"left",width:"150",prop:"routeName"}),u(Ee,{label:"路由路径",align:"left",width:"150",prop:"routePath"}),u(Ee,{label:"组件路径",align:"left",width:"250",prop:"component"}),u(Ee,{label:"权限标识",align:"center",width:"200",prop:"perm"}),u(Ee,{label:"状态",align:"center",width:"80"},{default:n((e=>[1===e.row.visible?(s(),y(Te,{key:0,type:"success"},{default:n((()=>[c("显示")])),_:1})):(s(),y(Te,{key:1,type:"info"},{default:n((()=>[c("隐藏")])),_:1}))])),_:1}),u(Ee,{label:"排序",align:"center",width:"80",prop:"sort"}),u(Ee,{fixed:"right",align:"center",label:"操作",width:"220"},{default:n((e=>["CATALOG"==e.row.type||"MENU"==e.row.type?f((s(),y(ye,{key:0,type:"primary",link:"",size:"small",onClick:k((l=>ke(e.row.id)),["stop"])},{default:n((()=>[u(je),c("新增 ")])),_:2},1032,["onClick"])),[[ze,["sys:menu:add"]]]):_("",!0),f((s(),y(ye,{type:"primary",link:"",size:"small",onClick:k((l=>ke(void 0,e.row.id)),["stop"])},{default:n((()=>[u(Ae),c("编辑 ")])),_:2},1032,["onClick"])),[[ze,["sys:menu:edit"]]]),f((s(),y(ye,{type:"danger",link:"",size:"small",onClick:k((l=>function(e){if(!e)return U.warning("请勾选删除项"),!1;j.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{ie.value=!0,w.deleteById(e).then((()=>{U.success("删除成功"),ve()})).finally((()=>{ie.value=!1}))}),(()=>{U.info("已取消删除")}))}(e.row.id)),["stop"])},{default:n((()=>[u(xe),c(" 删除 ")])),_:2},1032,["onClick"])),[[ze,["sys:menu:delete"]]])])),_:1})])),_:1},8,["data"])),[[Se,p(ie)]])])),_:1}),u(Xe,{modelValue:p(de).visible,"onUpdate:modelValue":l[19]||(l[19]=e=>p(de).visible=e),title:p(de).title,onClose:Ve,size:"50%"},{footer:n((()=>[d("div",oe,[u(ye,{type:"primary",onClick:ge},{default:n((()=>[c("确 定")])),_:1}),u(ye,{onClick:Ve},{default:n((()=>[c("取 消")])),_:1})])])),default:n((()=>[u(Ue,{ref_key:"menuFormRef",ref:se,model:p(ce),rules:p(fe),"label-width":"100px"},{default:n((()=>[u(t,{label:"父级菜单",prop:"parentId"},{default:n((()=>[u(Me,{modelValue:p(ce).parentId,"onUpdate:modelValue":l[2]||(l[2]=e=>p(ce).parentId=e),placeholder:"选择上级菜单",data:p(pe),filterable:"","check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])])),_:1}),u(t,{label:"菜单名称",prop:"name"},{default:n((()=>[u(a,{modelValue:p(ce).name,"onUpdate:modelValue":l[3]||(l[3]=e=>p(ce).name=e),placeholder:"请输入菜单名称"},null,8,["modelValue"])])),_:1}),u(t,{label:"菜单类型",prop:"type"},{default:n((()=>[u(Ie,{modelValue:p(ce).type,"onUpdate:modelValue":l[4]||(l[4]=e=>p(ce).type=e),onChange:be},{default:n((()=>[u(Pe,{value:"CATALOG"},{default:n((()=>[c("目录")])),_:1}),u(Pe,{value:"MENU"},{default:n((()=>[c("菜单")])),_:1}),u(Pe,{value:"BUTTON"},{default:n((()=>[c("按钮")])),_:1}),u(Pe,{value:"EXTLINK"},{default:n((()=>[c("外链")])),_:1})])),_:1},8,["modelValue"])])),_:1}),"EXTLINK"==p(ce).type?(s(),y(t,{key:0,label:"外链地址",prop:"path"},{default:n((()=>[u(a,{modelValue:p(ce).routePath,"onUpdate:modelValue":l[5]||(l[5]=e=>p(ce).routePath=e),placeholder:"请输入外链完整路径"},null,8,["modelValue"])])),_:1})):_("",!0),p(ce).type==p($).MENU?(s(),y(t,{key:1,prop:"routeName"},{label:n((()=>[d("div",null,[c(" 路由名称 "),u(Ge,{placement:"bottom",effect:"light"},{content:n((()=>[c(" 如果需要开启缓存，需保证页面 defineOptions 中的 name 与此处一致，建议使用驼峰。 ")])),default:n((()=>[u(qe,{class:"inline-block"})])),_:1})])])),default:n((()=>[u(a,{modelValue:p(ce).routeName,"onUpdate:modelValue":l[6]||(l[6]=e=>p(ce).routeName=e),placeholder:"User"},null,8,["modelValue"])])),_:1})):_("",!0),p(ce).type==p($).CATALOG||p(ce).type==p($).MENU?(s(),y(t,{key:2,prop:"routePath"},{label:n((()=>[d("div",null,[c(" 路由路径 "),u(Ge,{placement:"bottom",effect:"light"},{content:n((()=>[c(" 定义应用中不同页面对应的 URL 路径，目录需以 / 开头，菜单项不用。例如：系统管理目录 /system，系统管理下的用户管理菜单 user。 ")])),default:n((()=>[u(qe,{class:"inline-block"})])),_:1})])])),default:n((()=>[p(ce).type==p($).CATALOG?(s(),y(a,{key:0,modelValue:p(ce).routePath,"onUpdate:modelValue":l[7]||(l[7]=e=>p(ce).routePath=e),placeholder:"system"},null,8,["modelValue"])):(s(),y(a,{key:1,modelValue:p(ce).routePath,"onUpdate:modelValue":l[8]||(l[8]=e=>p(ce).routePath=e),placeholder:"user"},null,8,["modelValue"]))])),_:1})):_("",!0),p(ce).type==p($).MENU?(s(),y(t,{key:3,prop:"component"},{label:n((()=>[d("div",null,[c(" 组件路径 "),u(Ge,{placement:"bottom",effect:"light"},{content:n((()=>[c(" 组件页面完整路径，相对于 src/views/，如 system/user/index，缺省后缀 .vue ")])),default:n((()=>[u(qe,{class:"inline-block"})])),_:1})])])),default:n((()=>[u(a,{modelValue:p(ce).component,"onUpdate:modelValue":l[9]||(l[9]=e=>p(ce).component=e),placeholder:"system/user/index",style:{width:"95%"}},b({_:2},[p(ce).type==p($).MENU?{name:"prepend",fn:n((()=>[c("src/views/")])),key:"0"}:void 0,p(ce).type==p($).MENU?{name:"append",fn:n((()=>[c(".vue")])),key:"1"}:void 0]),1032,["modelValue"])])),_:1})):_("",!0),p(ce).type==p($).MENU?(s(),y(t,{key:4},{label:n((()=>[d("div",null,[c(" 路由参数 "),u(Ge,{placement:"bottom",effect:"light"},{content:n((()=>[c(" 组件页面使用 `useRoute().query.参数名` 获取路由参数值。 ")])),default:n((()=>[u(qe,{class:"inline-block"})])),_:1})])])),default:n((()=>[p(ce).params&&0!==p(ce).params.length?(s(),i("div",ee,[(s(!0),i(g,null,V(p(ce).params,((e,t)=>(s(),i("div",{key:t},[u(a,{modelValue:e.key,"onUpdate:modelValue":l=>e.key=l,placeholder:"参数名",class:"w-[100px]"},null,8,["modelValue","onUpdate:modelValue"]),le,u(a,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,placeholder:"参数值",class:"w-[100px]"},null,8,["modelValue","onUpdate:modelValue"]),p(ce).params.indexOf(e)===p(ce).params.length-1?(s(),y(Ne,{key:0,class:"ml-2 cursor-pointer color-[var(--el-color-success)]",style:{"vertical-align":"-0.15em"},onClick:l[11]||(l[11]=e=>p(ce).params.push({key:"",value:""}))},{default:n((()=>[u(Be)])),_:1})):_("",!0),u(Ne,{class:"ml-2 cursor-pointer color-[var(--el-color-danger)]",style:{"vertical-align":"-0.15em"},onClick:l=>p(ce).params.splice(p(ce).params.indexOf(e),1)},{default:n((()=>[u(Fe)])),_:2},1032,["onClick"])])))),128))])):(s(),i("div",Z,[u(ye,{type:"success",plain:"",onClick:l[10]||(l[10]=e=>p(ce).params=[{key:"",value:""}])},{default:n((()=>[c("添加路由参数")])),_:1})]))])),_:1})):_("",!0),p(ce).type!==p($).BUTTON?(s(),y(t,{key:5,prop:"visible",label:"显示状态"},{default:n((()=>[u(Ie,{modelValue:p(ce).visible,"onUpdate:modelValue":l[12]||(l[12]=e=>p(ce).visible=e)},{default:n((()=>[u(Pe,{value:1},{default:n((()=>[c("显示")])),_:1}),u(Pe,{value:0},{default:n((()=>[c("隐藏")])),_:1})])),_:1},8,["modelValue"])])),_:1})):_("",!0),p(ce).type===p($).CATALOG||p(ce).type===p($).MENU?(s(),y(t,{key:6},{label:n((()=>[d("div",null,[c(" 始终显示 "),u(Ge,{placement:"bottom",effect:"light"},{content:n((()=>[c(" 选择“是”，即使目录或菜单下只有一个子节点，也会显示父节点。"),ae,c(" 选择“否”，如果目录或菜单下只有一个子节点，则只显示该子节点，隐藏父节点。"),te,c(" 如果是叶子节点，请选择“否”。 ")])),default:n((()=>[u(qe,{class:"inline-block"})])),_:1})])])),default:n((()=>[u(Ie,{modelValue:p(ce).alwaysShow,"onUpdate:modelValue":l[13]||(l[13]=e=>p(ce).alwaysShow=e)},{default:n((()=>[u(Pe,{value:1},{default:n((()=>[c("是")])),_:1}),u(Pe,{value:0},{default:n((()=>[c("否")])),_:1})])),_:1},8,["modelValue"])])),_:1})):_("",!0),p(ce).type===p($).MENU?(s(),y(t,{key:7,label:"页面缓存"},{default:n((()=>[u(Ie,{modelValue:p(ce).keepAlive,"onUpdate:modelValue":l[14]||(l[14]=e=>p(ce).keepAlive=e)},{default:n((()=>[u(Pe,{value:1},{default:n((()=>[c("开启")])),_:1}),u(Pe,{value:0},{default:n((()=>[c("关闭")])),_:1})])),_:1},8,["modelValue"])])),_:1})):_("",!0),u(t,{label:"排序",prop:"sort"},{default:n((()=>[u(Ke,{modelValue:p(ce).sort,"onUpdate:modelValue":l[15]||(l[15]=e=>p(ce).sort=e),style:{width:"100px"},"controls-position":"right",min:0},null,8,["modelValue"])])),_:1}),p(ce).type==p($).BUTTON?(s(),y(t,{key:8,label:"权限标识",prop:"perm"},{default:n((()=>[u(a,{modelValue:p(ce).perm,"onUpdate:modelValue":l[16]||(l[16]=e=>p(ce).perm=e),placeholder:"sys:user:add"},null,8,["modelValue"])])),_:1})):_("",!0),p(ce).type!==p($).BUTTON?(s(),y(t,{key:9,label:"图标",prop:"icon"},{default:n((()=>[u(Re,{modelValue:p(ce).icon,"onUpdate:modelValue":l[17]||(l[17]=e=>p(ce).icon=e)},null,8,["modelValue"])])),_:1})):_("",!0),p(ce).type==p($).CATALOG?(s(),y(t,{key:10,label:"跳转路由"},{default:n((()=>[u(a,{modelValue:p(ce).redirect,"onUpdate:modelValue":l[18]||(l[18]=e=>p(ce).redirect=e),placeholder:"跳转路由"},null,8,["modelValue"])])),_:1})):_("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}});export{re as default};
