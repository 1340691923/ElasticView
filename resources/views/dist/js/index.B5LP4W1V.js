import{d as e,r as l,a0 as a,o as t,bG as s,e as o,h as r,C as d,l as i,w as n,g as u,a4 as p,a7 as m,a3 as c,f,j as h,aY as b,aP as y,a5 as _,a6 as j,bc as g}from"./index.DMBpWXpT.js";/* empty css                   */import{E as v}from"./el-dialog.DGaSOiRM.js";import{E as k,a as V}from"./el-radio.B-TDguQR.js";import{E as w}from"./el-input-number.zcrW3MHJ.js";/* empty css               */import{E as x,a as C}from"./el-select.C9ddzdnq.js";import"./el-scrollbar.BJ_tYB1D.js";import"./el-popper.Cb3Eus9m.js";import"./el-tree.UTBgh5GW.js";import"./el-checkbox.8MJHthul.js";import{E}from"./el-tree-select.BGIuc0mE.js";import{E as U}from"./el-card.BhvZLWwX.js";import{E as I,a as q}from"./el-table-column.Dl1jn1Bd.js";import"./el-tooltip.l0sNRNKZ.js";import{_ as F,a as z}from"./delete.CrlEmVes.js";import{_ as A}from"./plus.BhbEy4-l.js";import{E as B,a as D}from"./el-form.DUR-mZNt.js";import{_ as O}from"./refresh.BxJIPU5v.js";import{_ as P}from"./search.DdQbLJWh.js";import"./el-form-item.l0sNRNKZ.js";import{D as R}from"./dept.o4EvKKVx.js";import{E as K}from"./index.qeCV5ckY.js";import"./use-dialog.CoOh9qjD.js";import"./isUndefined.DgmxjSXK.js";import"./refs.BiRbkTK3.js";import"./index.tvUbLRs9.js";import"./token.DWNpOE8r.js";import"./strings.DeQ3Zoz4.js";import"./isEqual.B61-3bNT.js";import"./_Uint8Array.BEOPqGcx.js";import"./debounce.l44evi-0.js";import"./index.CP01f_MK.js";import"./castArray.arHVDzqw.js";const L={class:"app-container"},T={class:"search-container"},G={class:"dialog-footer"},N=e({name:"Dept",inheritAttrs:!1,__name:"index",setup(e){const N=l(B),Q=l(B),S=l(!1),W=l([]),X=a({title:"",visible:!1}),Y=a({}),$=l(),H=l(),J=a({status:1,parentId:0,sort:1}),M=a({parentId:[{required:!0,message:"上级部门不能为空",trigger:"change"}],name:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],code:[{required:!0,message:"部门编号不能为空",trigger:"blur"}],sort:[{required:!0,message:"显示排序不能为空",trigger:"blur"}]});function Z(){S.value=!0,R.getList(Y).then((e=>{$.value=e,S.value=!1}))}function ee(){N.value.resetFields(),Z()}function le(e){W.value=e.map((e=>e.id))}async function ae(e,l){const a=await R.getOptions();H.value=[{value:0,label:"顶级部门",children:a}],X.visible=!0,l?(X.title="修改部门",R.getFormData(l).then((e=>{Object.assign(J,e)}))):(X.title="新增部门",J.parentId=e??0)}function te(){Q.value.validate((e=>{if(e){S.value=!0;const e=J.id;e?R.update(e,J).then((()=>{b.success("修改成功"),oe(),Z()})).finally((()=>S.value=!1)):R.add(J).then((()=>{b.success("新增成功"),oe(),Z()})).finally((()=>S.value=!1))}}))}function se(e){const l=[e||W.value].join(",");l?y.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{S.value=!0,R.deleteByIds(l).then((()=>{b.success("删除成功"),ee()})).finally((()=>S.value=!1))}),(()=>{b.info("已取消删除")})):b.warning("请勾选删除项")}function oe(){X.visible=!1,Q.value.resetFields(),Q.value.clearValidate(),J.id=void 0,J.parentId=0,J.status=1,J.sort=1}return t((()=>{Z()})),(e,l)=>{const a=_,t=D,b=x,y=C,R=P,re=j,de=O,ie=B,ne=A,ue=F,pe=I,me=K,ce=z,fe=q,he=U,be=E,ye=w,_e=k,je=V,ge=v,ve=s("hasPerm"),ke=g;return o(),r("div",L,[d("div",T,[i(ie,{ref_key:"queryFormRef",ref:N,model:u(Y),inline:!0},{default:n((()=>[i(t,{label:"关键字",prop:"keywords"},{default:n((()=>[i(a,{modelValue:u(Y).keywords,"onUpdate:modelValue":l[0]||(l[0]=e=>u(Y).keywords=e),placeholder:"部门名称",onKeyup:p(Z,["enter"])},null,8,["modelValue"])])),_:1}),i(t,{label:"部门状态",prop:"status"},{default:n((()=>[i(y,{modelValue:u(Y).status,"onUpdate:modelValue":l[1]||(l[1]=e=>u(Y).status=e),placeholder:"全部",clearable:"",class:"!w-[100px]"},{default:n((()=>[i(b,{value:1,label:"正常"}),i(b,{value:0,label:"禁用"})])),_:1},8,["modelValue"])])),_:1}),i(t,null,{default:n((()=>[i(re,{class:"filter-item",type:"primary",onClick:Z},{default:n((()=>[i(R),m(" 搜索 ")])),_:1}),i(re,{onClick:ee},{default:n((()=>[i(de),m("重置 ")])),_:1})])),_:1})])),_:1},8,["model"])]),i(he,{shadow:"never",class:"table-container"},{header:n((()=>[c((o(),f(re,{type:"success",onClick:l[2]||(l[2]=e=>ae(0,void 0))},{default:n((()=>[i(ne),m("新增")])),_:1})),[[ve,["sys:dept:add"]]]),c((o(),f(re,{type:"danger",disabled:0===u(W).length,onClick:l[3]||(l[3]=e=>se())},{default:n((()=>[i(ue),m("删除 ")])),_:1},8,["disabled"])),[[ve,["sys:dept:delete"]]])])),default:n((()=>[c((o(),f(fe,{data:u($),"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},onSelectionChange:le},{default:n((()=>[i(pe,{type:"selection",width:"55",align:"center"}),i(pe,{prop:"name",label:"部门名称","min-width":"200"}),i(pe,{prop:"code",label:"部门编号",width:"200"}),i(pe,{prop:"status",label:"状态",width:"100"},{default:n((e=>[1==e.row.status?(o(),f(me,{key:0,type:"success"},{default:n((()=>[m("正常")])),_:1})):(o(),f(me,{key:1,type:"info"},{default:n((()=>[m("禁用")])),_:1}))])),_:1}),i(pe,{prop:"sort",label:"排序",width:"100"}),i(pe,{label:"操作",fixed:"right",align:"left",width:"200"},{default:n((e=>[c((o(),f(re,{type:"primary",link:"",size:"small",onClick:h((l=>ae(e.row.id,void 0)),["stop"])},{default:n((()=>[i(ne),m("新增 ")])),_:2},1032,["onClick"])),[[ve,["sys:dept:add"]]]),c((o(),f(re,{type:"primary",link:"",size:"small",onClick:h((l=>ae(e.row.parentId,e.row.id)),["stop"])},{default:n((()=>[i(ce),m("编辑 ")])),_:2},1032,["onClick"])),[[ve,["sys:dept:edit"]]]),c((o(),f(re,{type:"danger",link:"",size:"small",onClick:h((l=>se(e.row.id)),["stop"])},{default:n((()=>[i(ue),m("删除 ")])),_:2},1032,["onClick"])),[[ve,["sys:dept:delete"]]])])),_:1})])),_:1},8,["data"])),[[ke,u(S)]])])),_:1}),i(ge,{modelValue:u(X).visible,"onUpdate:modelValue":l[9]||(l[9]=e=>u(X).visible=e),title:u(X).title,width:"600px",onClosed:oe},{footer:n((()=>[d("div",G,[i(re,{type:"primary",onClick:te},{default:n((()=>[m(" 确 定 ")])),_:1}),i(re,{onClick:oe},{default:n((()=>[m(" 取 消 ")])),_:1})])])),default:n((()=>[i(ie,{ref_key:"deptFormRef",ref:Q,model:u(J),rules:u(M),"label-width":"80px"},{default:n((()=>[i(t,{label:"上级部门",prop:"parentId"},{default:n((()=>[i(be,{modelValue:u(J).parentId,"onUpdate:modelValue":l[4]||(l[4]=e=>u(J).parentId=e),placeholder:"选择上级部门",data:u(H),filterable:"","check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])])),_:1}),i(t,{label:"部门名称",prop:"name"},{default:n((()=>[i(a,{modelValue:u(J).name,"onUpdate:modelValue":l[5]||(l[5]=e=>u(J).name=e),placeholder:"请输入部门名称"},null,8,["modelValue"])])),_:1}),i(t,{label:"部门编号",prop:"code"},{default:n((()=>[i(a,{modelValue:u(J).code,"onUpdate:modelValue":l[6]||(l[6]=e=>u(J).code=e),placeholder:"请输入部门编号"},null,8,["modelValue"])])),_:1}),i(t,{label:"显示排序",prop:"sort"},{default:n((()=>[i(ye,{modelValue:u(J).sort,"onUpdate:modelValue":l[7]||(l[7]=e=>u(J).sort=e),"controls-position":"right",style:{width:"100px"},min:0},null,8,["modelValue"])])),_:1}),i(t,{label:"部门状态"},{default:n((()=>[i(je,{modelValue:u(J).status,"onUpdate:modelValue":l[8]||(l[8]=e=>u(J).status=e)},{default:n((()=>[i(_e,{label:1},{default:n((()=>[m("正常")])),_:1}),i(_e,{label:0},{default:n((()=>[m("禁用")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}});export{N as default};
