import{v as e,A as l,bf as a,M as t,U as o,N as s,bg as r,P as i,as as d,d as n,bh as u,bi as c,Y as f,b as p,r as m,b8 as h,c as g,bj as b,o as y,e as v,f as C,w as k,C as w,i as E,g as V,n as _,l as $,h as F,k as x,E as L,bk as S,S as A,V as U,a7 as j,F as T,a5 as R,a8 as B,a4 as O,j as M,b9 as q,_ as D,bl as I,t as P,q as N,ao as W,O as K,bm as H,J,ae as z,y as Q,a0 as Y,bn as X,bd as Z,aB as G,aC as ee,p as le,a3 as ae,aa as te,W as oe,ac as se,am as re,bo as ie,bp as de,a6 as ne,ak as ue,bq as ce,br as fe,aY as pe,bs as me,bt as he,bu as ge,bv as be,aP as ye,bw as ve,bx as Ce,by as ke,au as we,bc as Ee}from"./index.DMBpWXpT.js";/* empty css                   */import{E as Ve}from"./el-drawer.CpqknkfB.js";import{E as _e}from"./el-scrollbar.BJ_tYB1D.js";import{u as $e,E as Fe}from"./el-popper.Cb3Eus9m.js";import{E as xe,a as Le}from"./el-checkbox.8MJHthul.js";/* empty css                          */import{E as Se}from"./el-card.BhvZLWwX.js";import{E as Ae,a as Ue}from"./el-table-column.Dl1jn1Bd.js";import"./el-tooltip.l0sNRNKZ.js";/* empty css               */import{a as je,E as Te}from"./el-form.DUR-mZNt.js";import"./el-form-item.l0sNRNKZ.js";import{d as Re}from"./index.B6fdKp2E.js";import{P as Be}from"./es.Bcp-0uIV.js";import Oe from"./EsHeader.BozPtybD.js";import{_ as Me}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{E as qe}from"./index.qeCV5ckY.js";import{d as De}from"./debounce.l44evi-0.js";import"./use-dialog.CoOh9qjD.js";import"./isUndefined.DgmxjSXK.js";import"./isEqual.B61-3bNT.js";import"./_Uint8Array.BEOPqGcx.js";import"./index.CP01f_MK.js";import"./castArray.arHVDzqw.js";const Ie=e({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:l(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:l([Function,Array]),default:a},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},teleported:$e.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String,...t(["ariaLabel"])}),Pe={[o]:e=>s(e),[r]:e=>s(e),[i]:e=>s(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,select:e=>d(e)},Ne=["aria-expanded","aria-owns"],We={key:0},Ke=["id","aria-selected","onClick"],He="ElAutocomplete",Je=n({name:He,inheritAttrs:!1});const ze=N(D(n({...Je,props:Ie,emits:Pe,setup(e,{expose:l,emit:a}){const t=e,s=u(),d=c(),n=f(),D=p("autocomplete"),N=m(),W=m(),K=m(),H=m();let J=!1,z=!1;const Q=m([]),Y=m(-1),X=m(""),Z=m(!1),G=m(!1),ee=m(!1),le=h(),ae=g((()=>d.style)),te=g((()=>(Q.value.length>0||ee.value)&&Z.value)),oe=g((()=>!t.hideLoading&&ee.value)),se=g((()=>N.value?Array.from(N.value.$el.querySelectorAll("input")):[])),re=()=>{te.value&&(X.value=`${N.value.$el.offsetWidth}px`)},ie=()=>{Y.value=-1},de=De((async e=>{if(G.value)return;const l=e=>{ee.value=!1,G.value||(I(e)?(Q.value=e,Y.value=t.highlightFirstItem?0:-1):P(He,"autocomplete suggestions must be an array"))};if(ee.value=!0,I(t.fetchSuggestions))l(t.fetchSuggestions);else{const a=await t.fetchSuggestions(e,l);I(a)&&l(a)}}),t.debounce),ne=e=>{const l=!!e;if(a(r,e),a(o,e),G.value=!1,Z.value||(Z.value=l),!t.triggerOnFocus&&!e)return G.value=!0,void(Q.value=[]);de(e)},ue=e=>{var l;n.value||("INPUT"!==(null==(l=e.target)?void 0:l.tagName)||se.value.includes(document.activeElement))&&(Z.value=!0)},ce=e=>{a(i,e)},fe=e=>{z?z=!1:(Z.value=!0,a("focus",e),t.triggerOnFocus&&!J&&de(String(t.modelValue)))},pe=e=>{setTimeout((()=>{var l;(null==(l=K.value)?void 0:l.isFocusInsideContent())?z=!0:(Z.value&&be(),a("blur",e))}))},me=()=>{Z.value=!1,a(o,""),a("clear")},he=async()=>{te.value&&Y.value>=0&&Y.value<Q.value.length?ye(Q.value[Y.value]):t.selectWhenUnmatched&&(a("select",{value:t.modelValue}),Q.value=[],Y.value=-1)},ge=e=>{te.value&&(e.preventDefault(),e.stopPropagation(),be())},be=()=>{Z.value=!1},ye=async e=>{a(r,e[t.valueKey]),a(o,e[t.valueKey]),a("select",e),Q.value=[],Y.value=-1},ve=e=>{if(!te.value||ee.value)return;if(e<0)return void(Y.value=-1);e>=Q.value.length&&(e=Q.value.length-1);const l=W.value.querySelector(`.${D.be("suggestion","wrap")}`),a=l.querySelectorAll(`.${D.be("suggestion","list")} li`)[e],t=l.scrollTop,{offsetTop:o,scrollHeight:s}=a;o+s>t+l.clientHeight&&(l.scrollTop+=s),o<t&&(l.scrollTop-=s),Y.value=e,N.value.ref.setAttribute("aria-activedescendant",`${le.value}-item-${Y.value}`)};return b(H,(()=>{te.value&&be()})),y((()=>{N.value.ref.setAttribute("role","textbox"),N.value.ref.setAttribute("aria-autocomplete","list"),N.value.ref.setAttribute("aria-controls","id"),N.value.ref.setAttribute("aria-activedescendant",`${le.value}-item-${Y.value}`),J=N.value.ref.hasAttribute("readonly")})),l({highlightedIndex:Y,activated:Z,loading:ee,inputRef:N,popperRef:K,suggestions:Q,handleSelect:ye,handleKeyEnter:he,focus:()=>{var e;null==(e=N.value)||e.focus()},blur:()=>{var e;null==(e=N.value)||e.blur()},close:be,highlight:ve}),(e,l)=>(v(),C(V(Fe),{ref_key:"popperRef",ref:K,visible:V(te),placement:e.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[V(D).e("popper"),e.popperClass],teleported:e.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${V(D).namespace.value}-zoom-in-top`,persistent:"",role:"listbox",onBeforeShow:re,onHide:ie},{content:k((()=>[w("div",{ref_key:"regionRef",ref:W,class:E([V(D).b("suggestion"),V(D).is("loading",V(oe))]),style:_({[e.fitInputWidth?"width":"minWidth"]:X.value,outline:"none"}),role:"region"},[$(V(_e),{id:V(le),tag:"ul","wrap-class":V(D).be("suggestion","wrap"),"view-class":V(D).be("suggestion","list"),role:"listbox"},{default:k((()=>[V(oe)?(v(),F("li",We,[x(e.$slots,"loading",{},(()=>[$(V(L),{class:E(V(D).is("loading"))},{default:k((()=>[$(V(S))])),_:1},8,["class"])]))])):(v(!0),F(A,{key:1},U(Q.value,((l,a)=>(v(),F("li",{id:`${V(le)}-item-${a}`,key:a,class:E({highlighted:Y.value===a}),role:"option","aria-selected":Y.value===a,onClick:e=>ye(l)},[x(e.$slots,"default",{item:l},(()=>[j(T(l[e.valueKey]),1)]))],10,Ke)))),128))])),_:3},8,["id","wrap-class","view-class"])],6)])),default:k((()=>[w("div",{ref_key:"listboxRef",ref:H,class:E([V(D).b(),e.$attrs.class]),style:_(V(ae)),role:"combobox","aria-haspopup":"listbox","aria-expanded":V(te),"aria-owns":V(le)},[$(V(R),B({ref_key:"inputRef",ref:N},V(s),{clearable:e.clearable,disabled:V(n),name:e.name,"model-value":e.modelValue,"aria-label":e.ariaLabel,onInput:ne,onChange:ce,onFocus:fe,onBlur:pe,onClear:me,onKeydown:[l[0]||(l[0]=O(M((e=>ve(Y.value-1)),["prevent"]),["up"])),l[1]||(l[1]=O(M((e=>ve(Y.value+1)),["prevent"]),["down"])),O(he,["enter"]),O(be,["tab"]),O(ge,["esc"])],onMousedown:ue}),q({_:2},[e.$slots.prepend?{name:"prepend",fn:k((()=>[x(e.$slots,"prepend")]))}:void 0,e.$slots.append?{name:"append",fn:k((()=>[x(e.$slots,"append")]))}:void 0,e.$slots.prefix?{name:"prefix",fn:k((()=>[x(e.$slots,"prefix")]))}:void 0,e.$slots.suffix?{name:"suffix",fn:k((()=>[x(e.$slots,"suffix")]))}:void 0]),1040,["clearable","disabled","name","model-value","aria-label","onKeydown"])],14,Ne)])),_:3},8,["visible","placement","popper-class","teleported","transition"]))}}),[["__file","autocomplete.vue"]])),Qe="left-check-change",Ye="right-check-change",Xe=e({data:{type:l(Array),default:()=>[]},titles:{type:l(Array),default:()=>[]},buttonTexts:{type:l(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:l(Function)},leftDefaultChecked:{type:l(Array),default:()=>[]},rightDefaultChecked:{type:l(Array),default:()=>[]},renderContent:{type:l(Function)},modelValue:{type:l(Array),default:()=>[]},format:{type:l(Object),default:()=>({})},filterable:Boolean,props:{type:l(Object),default:()=>W({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),Ze=(e,l)=>[e,l].every(I)||I(e)&&K(l),Ge={[i]:(e,l,a)=>[e,a].every(I)&&["left","right"].includes(l),[o]:e=>I(e),[Qe]:Ze,[Ye]:Ze},el="checked-change",ll=e({data:Xe.data,optionRender:{type:l(Function)},placeholder:String,title:String,filterable:Boolean,format:Xe.format,filterMethod:Xe.filterMethod,defaultChecked:Xe.leftDefaultChecked,props:Xe.props}),al={[el]:Ze},tl=e=>{const l={label:"label",key:"key",disabled:"disabled"};return g((()=>({...l,...e.props})))},ol=n({name:"ElTransferPanel"});var sl=D(n({...ol,props:ll,emits:al,setup(e,{expose:l,emit:a}){const t=e,o=z(),s=({option:e})=>e,{t:r}=Q(),i=p("transfer"),d=Y({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),n=tl(t),{filteredData:u,checkedSummary:c,isIndeterminate:f,handleAllCheckedChange:m}=((e,l,a)=>{const t=tl(e),o=g((()=>e.data.filter((a=>H(e.filterMethod)?e.filterMethod(l.query,a):String(a[t.value.label]||a[t.value.key]).toLowerCase().includes(l.query.toLowerCase()))))),s=g((()=>o.value.filter((e=>!e[t.value.disabled])))),r=g((()=>{const a=l.checked.length,t=e.data.length,{noChecked:o,hasChecked:s}=e.format;return o&&s?a>0?s.replace(/\${checked}/g,a.toString()).replace(/\${total}/g,t.toString()):o.replace(/\${total}/g,t.toString()):`${a}/${t}`})),i=g((()=>{const e=l.checked.length;return e>0&&e<s.value.length})),d=()=>{const e=s.value.map((e=>e[t.value.key]));l.allChecked=e.length>0&&e.every((e=>l.checked.includes(e)))};return J((()=>l.checked),((e,t)=>{if(d(),l.checkChangeByUser){const l=e.concat(t).filter((l=>!e.includes(l)||!t.includes(l)));a(el,e,l)}else a(el,e),l.checkChangeByUser=!0})),J(s,(()=>{d()})),J((()=>e.data),(()=>{const e=[],a=o.value.map((e=>e[t.value.key]));l.checked.forEach((l=>{a.includes(l)&&e.push(l)})),l.checkChangeByUser=!1,l.checked=e})),J((()=>e.defaultChecked),((e,a)=>{if(a&&e.length===a.length&&e.every((e=>a.includes(e))))return;const o=[],r=s.value.map((e=>e[t.value.key]));e.forEach((e=>{r.includes(e)&&o.push(e)})),l.checkChangeByUser=!1,l.checked=o}),{immediate:!0}),{filteredData:o,checkableData:s,checkedSummary:r,isIndeterminate:i,updateAllChecked:d,handleAllCheckedChange:e=>{l.checked=e?s.value.map((e=>e[t.value.key])):[]}}})(t,d,a),h=g((()=>!X(d.query)&&X(u.value))),b=g((()=>!X(o.default()[0].children))),{checked:y,allChecked:_,query:L}=Z(d);return l({query:L}),(e,l)=>(v(),F("div",{class:E(V(i).b("panel"))},[w("p",{class:E(V(i).be("panel","header"))},[$(V(xe),{modelValue:V(_),"onUpdate:modelValue":l[0]||(l[0]=e=>G(_)?_.value=e:null),indeterminate:V(f),"validate-event":!1,onChange:V(m)},{default:k((()=>[j(T(e.title)+" ",1),w("span",null,T(V(c)),1)])),_:1},8,["modelValue","indeterminate","onChange"])],2),w("div",{class:E([V(i).be("panel","body"),V(i).is("with-footer",V(b))])},[e.filterable?(v(),C(V(R),{key:0,modelValue:V(L),"onUpdate:modelValue":l[1]||(l[1]=e=>G(L)?L.value=e:null),class:E(V(i).be("panel","filter")),size:"default",placeholder:e.placeholder,"prefix-icon":V(ee),clearable:"","validate-event":!1},null,8,["modelValue","class","placeholder","prefix-icon"])):le("v-if",!0),ae($(V(Le),{modelValue:V(y),"onUpdate:modelValue":l[2]||(l[2]=e=>G(y)?y.value=e:null),"validate-event":!1,class:E([V(i).is("filterable",e.filterable),V(i).be("panel","list")])},{default:k((()=>[(v(!0),F(A,null,U(V(u),(l=>(v(),C(V(xe),{key:l[V(n).key],class:E(V(i).be("panel","item")),value:l[V(n).key],disabled:l[V(n).disabled],"validate-event":!1},{default:k((()=>{var a;return[$(s,{option:null==(a=e.optionRender)?void 0:a.call(e,l)},null,8,["option"])]})),_:2},1032,["class","value","disabled"])))),128))])),_:1},8,["modelValue","class"]),[[te,!V(h)&&!V(X)(e.data)]]),ae(w("p",{class:E(V(i).be("panel","empty"))},T(V(h)?V(r)("el.transfer.noMatch"):V(r)("el.transfer.noData")),3),[[te,V(h)||V(X)(e.data)]])],2),V(b)?(v(),F("p",{key:0,class:E(V(i).be("panel","footer"))},[x(e.$slots,"default")],2)):le("v-if",!0)],2))}}),[["__file","transfer-panel.vue"]]);const rl={key:0},il={key:0},dl=n({name:"ElTransfer"});const nl=N(D(n({...dl,props:Xe,emits:Ge,setup(e,{expose:l,emit:a}){const t=e,s=z(),{t:r}=Q(),d=p("transfer"),{formItem:n}=oe(),u=Y({leftChecked:[],rightChecked:[]}),c=tl(t),{sourceData:f,targetData:h}=(e=>{const l=tl(e),a=g((()=>e.data.reduce(((e,a)=>(e[a[l.value.key]]=a)&&e),{})));return{sourceData:g((()=>e.data.filter((a=>!e.modelValue.includes(a[l.value.key]))))),targetData:g((()=>"original"===e.targetOrder?e.data.filter((a=>e.modelValue.includes(a[l.value.key]))):e.modelValue.reduce(((e,l)=>{const t=a.value[l];return t&&e.push(t),e}),[])))}})(t),{onSourceCheckedChange:b,onTargetCheckedChange:y}=((e,l)=>({onSourceCheckedChange:(a,t)=>{e.leftChecked=a,t&&l(Qe,a,t)},onTargetCheckedChange:(a,t)=>{e.rightChecked=a,t&&l(Ye,a,t)}}))(u,a),{addToLeft:C,addToRight:_}=((e,l,a)=>{const t=tl(e),s=(e,l,t)=>{a(o,e),a(i,e,l,t)};return{addToLeft:()=>{const a=e.modelValue.slice();l.rightChecked.forEach((e=>{const l=a.indexOf(e);l>-1&&a.splice(l,1)})),s(a,"left",l.rightChecked)},addToRight:()=>{let a=e.modelValue.slice();const o=e.data.filter((a=>{const o=a[t.value.key];return l.leftChecked.includes(o)&&!e.modelValue.includes(o)})).map((e=>e[t.value.key]));a="unshift"===e.targetOrder?o.concat(a):a.concat(o),"original"===e.targetOrder&&(a=e.data.filter((e=>a.includes(e[t.value.key]))).map((e=>e[t.value.key]))),s(a,"right",l.leftChecked)}}})(t,u,a),S=m(),A=m(),U=g((()=>2===t.buttonTexts.length)),j=g((()=>t.titles[0]||r("el.transfer.titles.0"))),R=g((()=>t.titles[1]||r("el.transfer.titles.1"))),B=g((()=>t.filterPlaceholder||r("el.transfer.filterPlaceholder")));J((()=>t.modelValue),(()=>{var e;t.validateEvent&&(null==(e=null==n?void 0:n.validate)||e.call(n,"change").catch((e=>se())))}));const O=g((()=>e=>t.renderContent?t.renderContent(re,e):s.default?s.default({option:e}):re("span",e[c.value.label]||e[c.value.key])));return l({clearQuery:e=>{switch(e){case"left":S.value.query="";break;case"right":A.value.query=""}},leftPanel:S,rightPanel:A}),(e,l)=>(v(),F("div",{class:E(V(d).b())},[$(sl,{ref_key:"leftPanel",ref:S,data:V(f),"option-render":V(O),placeholder:V(B),title:V(j),filterable:e.filterable,format:e.format,"filter-method":e.filterMethod,"default-checked":e.leftDefaultChecked,props:t.props,onCheckedChange:V(b)},{default:k((()=>[x(e.$slots,"left-footer")])),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),w("div",{class:E(V(d).e("buttons"))},[$(V(ne),{type:"primary",class:E([V(d).e("button"),V(d).is("with-texts",V(U))]),disabled:V(X)(u.rightChecked),onClick:V(C)},{default:k((()=>[$(V(L),null,{default:k((()=>[$(V(ie))])),_:1}),V(de)(e.buttonTexts[0])?le("v-if",!0):(v(),F("span",rl,T(e.buttonTexts[0]),1))])),_:1},8,["class","disabled","onClick"]),$(V(ne),{type:"primary",class:E([V(d).e("button"),V(d).is("with-texts",V(U))]),disabled:V(X)(u.leftChecked),onClick:V(_)},{default:k((()=>[V(de)(e.buttonTexts[1])?le("v-if",!0):(v(),F("span",il,T(e.buttonTexts[1]),1)),$(V(L),null,{default:k((()=>[$(V(ue))])),_:1})])),_:1},8,["class","disabled","onClick"])],2),$(sl,{ref_key:"rightPanel",ref:A,data:V(h),"option-render":V(O),placeholder:V(B),filterable:e.filterable,format:e.format,"filter-method":e.filterMethod,title:V(R),"default-checked":e.rightDefaultChecked,props:t.props,onCheckedChange:V(y)},{default:k((()=>[x(e.$slots,"right-footer")])),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}}),[["__file","transfer.vue"]])),ul={id:0,ip:"http://127.0.0.1:9200",remark:"",version:6},cl={class:"app-container"},fl={class:"search-container"};const pl=Me({components:{EsHeader:Oe},data:()=>({managerFormdialogVisible:!1,refreshTable:!0,default_expand_all:!1,getListLoading:!1,usernameWord:[{value:"elastic"}],testConnectLoading:!1,connectLoading:!1,link:Object.assign({},ul),list:[],dialogVisible:!1,dialogType:"new",dialogAddCfgVisible:!1,dialogEditCfgVisible:!1,addEsCfgForm:{es_link_id:0,user:"",pwd:"",remark:"",rootpem:"",certpem:"",keypem:"",share_roles:[],header:[]},editEsCfgForm:{linkId:0,id:0,user:"",pwd:"",remark:"",rootpem:"",certpem:"",keypem:"",share_roles:[],header:[]},selectEsLinkId:0,selectEsVersion:0,selectEsIp:"",roleMap:{},roleList:[],allRoleConfig:[]}),setup:()=>({View:ce}),computed:{},async created(){await this.initAllRoles(),this.getList()},methods:{filterMethod:(e,l)=>l.label.indexOf(e)>-1,async initAllRoles(){const e=await fe();if(0==e.code){null==e.data&&(e.data=[]),this.roleMap={};for(let l of e.data)this.roleMap[l.id]=l.name;this.roleList=e.data}else pe.error({type:"error",message:e.msg})},querySearch(e,l){var a=this.usernameWord;l(e?a.filter(this.createFilter(e)):a)},createFilter:e=>l=>0===l.value.toLowerCase().indexOf(e.toLowerCase()),testConnectForm(e){this.testConnectLoading=!0,e.ip=this.selectEsIp,e.version=this.selectEsVersion,Be(e).then((e=>{0==e.code?pe.success({type:"success",message:"连接成功"}):pe.error({type:"error",message:e.msg}),this.testConnectLoading=!1})).catch((e=>{this.testConnectLoading=!1}))},testConnect(e){this.list[e.$index].connectLoading=!0,Be({ip:e.row.ip,user:e.row.user,pwd:e.row.pwd,version:e.row.version,rootpem:e.row.rootpem,certpem:e.row.certpem,keypem:e.row.keypem}).then((l=>{0==l.code?(console.log("res",l),pe.success({type:"success",message:"连接成功"})):pe.error({type:"error",message:l.msg}),this.list[e.$index].connectLoading=!1})).catch((l=>{this.list[e.$index].connectLoading=!1}))},async getList(){this.getListLoading=!0;const e=await me();this.getListLoading=!1,0==e.code?(pe.success({type:"success",message:e.msg}),this.list=e.data,this.refreshTable=!1,this.$nextTick((()=>{this.refreshTable=!0}))):pe.error({type:"error",message:e.msg})},handleAddRole(){this.link=Object.assign({},ul),this.dialogType="new",this.dialogVisible=!0},handleEdit(e){this.dialogType="edit",this.dialogVisible=!0,this.checkStrictly=!0,this.link=Re(e.row),this.link.pwd=""},handleAddEsCfg(){this.addEsCfgForm.share_roles=[],this.allRoleConfig=[];for(let e of this.roleList){const l={label:e.name,key:e.id.toString(),disabled:!1};this.allRoleConfig.push(l)}this.dialogAddCfgVisible=!0},handleEditEsCfg(e){this.editEsCfgForm.id=e.row.id,this.editEsCfgForm.user=e.row.user,this.editEsCfgForm.pwd=e.row.pwd,this.editEsCfgForm.remark=e.row.remark,this.editEsCfgForm.certpem=e.row.certpem,this.editEsCfgForm.keypem=e.row.keypem,this.editEsCfgForm.rootpem=e.row.rootpem,this.editEsCfgForm.share_roles=e.row.share_roles,this.editEsCfgForm.header=e.row.header,this.allRoleConfig=[];for(let l of this.roleList){const e={label:l.name,key:l.id.toString(),disabled:!1};this.allRoleConfig.push(e)}this.dialogEditCfgVisible=!0},async confirmEditEsCfg(){let e=JSON.parse(JSON.stringify(this.editEsCfgForm)),l=await he(e);0==l.code?(pe.success({type:"success",message:l.msg}),this.getList(),this.dialogEditCfgVisible=!1):pe.error({type:"error",message:l.msg})},async confirmEsCfg(){let e=JSON.parse(JSON.stringify(this.addEsCfgForm)),l=await ge(e);0==l.code?(pe.success({type:"success",message:l.msg}),this.getList(),this.dialogAddCfgVisible=!1):pe.error({type:"error",message:l.msg})},async deleteEsCfgAction(e){let l=await be({id:e.row.id});0==l.code?(pe.success({type:"success",message:l.msg}),this.getList()):pe.error({type:"error",message:l.msg})},handleDelete({$index:e,row:l}){ye.confirm("确定删除该连接信息吗?","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((async()=>{const e=await ve({id:l.id});0==e.code?this.getList():pe.error({type:"error",message:e.msg})})).catch((e=>{console.error(e)}))},async confirm(){const e="edit"===this.dialogType;if(e){const e=await Ce(this.link);if(0!=e.code)return void pe.error({type:"error",message:e.msg});this.getList()}else{const e=await ke(this.link);if(0!=e.code)return void pe.error({type:"error",message:e.msg});this.getList()}this.dialogVisible=!1,pe.success({type:"success",message:e?"修改成功":"创建成功"})}}},[["render",function(e,l,a,t,o,s){const r=ne,i=je,d=Te,n=Ae,u=qe,c=Ue,f=Se,p=R,m=nl,h=ze,g=we("es-header"),b=Ve,y=Ee;return v(),F("div",cl,[w("div",fl,[$(d,{inline:!0},{default:k((()=>[$(i,{label:""},{default:k((()=>[$(r,{type:"success",class:"filter-item",onClick:s.getList},{default:k((()=>[j(T(e.$t("搜索")),1)])),_:1},8,["onClick"])])),_:1}),$(i,{label:""},{default:k((()=>[$(r,{type:"primary",class:"filter-item",onClick:s.handleAddEsCfg},{default:k((()=>[j(T(e.$t("新建鉴权信息")),1)])),_:1},8,["onClick"])])),_:1})])),_:1})]),$(f,{shadow:"never",class:"table-container"},{default:k((()=>[o.refreshTable?ae((v(),C(c,{key:0,data:o.list},{default:k((()=>[$(n,{label:e.$t("备注"),align:"center"},{default:k((e=>[j(T(e.row.remark),1)])),_:1},8,["label"]),$(n,{align:"center",label:e.$t("已分配角色"),width:"200"},{default:k((e=>[(v(!0),F(A,null,U(e.row.share_roles,((e,l)=>(v(),C(u,null,{default:k((()=>[j(T(o.roleMap[e]),1)])),_:2},1024)))),256))])),_:1},8,["label"]),$(n,{align:"center",label:e.$t("用户名"),width:"200"},{default:k((e=>[j(T(e.row.user),1)])),_:1},8,["label"]),$(n,{align:"center",label:e.$t("root证书"),width:"100","show-overflow-tooltip":""},{default:k((e=>[j(T(e.row.rootpem),1)])),_:1},8,["label"]),$(n,{align:"center",label:e.$t("cert证书"),width:"100","show-overflow-tooltip":""},{default:k((e=>[j(T(e.row.certpem),1)])),_:1},8,["label"]),$(n,{align:"center",label:e.$t("key证书"),width:"100","show-overflow-tooltip":""},{default:k((e=>[j(T(e.row.keypem),1)])),_:1},8,["label"]),$(n,{align:"center",label:e.$t("创建时间"),width:"220"},{default:k((e=>[j(T(e.row.created),1)])),_:1},8,["label"]),$(n,{align:"center",label:e.$t("修改时间"),width:"220"},{default:k((e=>[j(T(e.row.updated),1)])),_:1},8,["label"]),$(n,{align:"center",label:e.$t("操作"),fixed:"right",width:"200"},{default:k((l=>[$(r,{type:"primary",onClick:e=>s.handleEditEsCfg(l)},{default:k((()=>[j(T(e.$t("编辑")),1)])),_:2},1032,["onClick"]),$(r,{type:"danger",onClick:e=>s.deleteEsCfgAction(l)},{default:k((()=>[j(T(e.$t("删除")),1)])),_:2},1032,["onClick"])])),_:1},8,["label"])])),_:1},8,["data"])),[[y,o.getListLoading]]):le("",!0)])),_:1}),$(b,{size:"80%",modelValue:o.dialogAddCfgVisible,"onUpdate:modelValue":l[9]||(l[9]=e=>o.dialogAddCfgVisible=e),title:e.$t("新建鉴权配置")},{footer:k((()=>[$(r,{type:"danger",onClick:l[8]||(l[8]=e=>o.dialogAddCfgVisible=!1)},{default:k((()=>[j(T(e.$t("取消")),1)])),_:1}),$(r,{type:"primary",onClick:s.confirmEsCfg},{default:k((()=>[j(T(e.$t("确认")),1)])),_:1},8,["onClick"])])),default:k((()=>[$(d,{model:o.addEsCfgForm,"label-width":"100px","label-position":"left"},{default:k((()=>[$(i,{label:e.$t("备注")},{default:k((()=>[$(p,{clearable:"",modelValue:o.addEsCfgForm.remark,"onUpdate:modelValue":l[0]||(l[0]=e=>o.addEsCfgForm.remark=e),placeholder:e.$t("备注")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),$(i,{label:e.$t("可访问集群成员")},{default:k((()=>[o.addEsCfgForm?(v(),C(m,{key:0,onChange:e.changeShareRoles,modelValue:o.addEsCfgForm.share_roles,"onUpdate:modelValue":l[1]||(l[1]=e=>o.addEsCfgForm.share_roles=e),titles:["全部角色","当前集群角色"],"button-texts":["移除角色","添加角色"],filterable:"","filter-method":s.filterMethod,"filter-placeholder":"请操作角色",data:o.allRoleConfig},null,8,["onChange","modelValue","filter-method","data"])):le("",!0)])),_:1},8,["label"]),$(i,{label:e.$t("用户名")},{default:k((()=>[$(h,{modelValue:o.addEsCfgForm.user,"onUpdate:modelValue":l[2]||(l[2]=e=>o.addEsCfgForm.user=e),clearable:"","fetch-suggestions":s.querySearch,placeholder:e.$t("用户名")},{default:k((({item:e})=>[w("span",null,T(e.value),1)])),_:1},8,["modelValue","fetch-suggestions","placeholder"])])),_:1},8,["label"]),$(i,{label:e.$t("密码")},{default:k((()=>[$(p,{"show-password":"",type:"password",clearable:"",modelValue:o.addEsCfgForm.pwd,"onUpdate:modelValue":l[3]||(l[3]=e=>o.addEsCfgForm.pwd=e),placeholder:e.$t("密码")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),$(i,{label:e.$t("root证书")},{default:k((()=>[$(p,{clearable:"",modelValue:o.addEsCfgForm.rootpem,"onUpdate:modelValue":l[4]||(l[4]=e=>o.addEsCfgForm.rootpem=e),type:"textarea",placeholder:e.$t("root证书")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),$(i,{label:e.$t("cert证书")},{default:k((()=>[$(p,{clearable:"",modelValue:o.addEsCfgForm.certpem,"onUpdate:modelValue":l[5]||(l[5]=e=>o.addEsCfgForm.certpem=e),type:"textarea",placeholder:e.$t("cert证书")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),$(i,{label:e.$t("key证书")},{default:k((()=>[$(p,{clearable:"",modelValue:o.addEsCfgForm.keypem,"onUpdate:modelValue":l[6]||(l[6]=e=>o.addEsCfgForm.keypem=e),type:"textarea",placeholder:e.$t("key证书")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),$(i,{label:e.$t("自定义请求头")},{default:k((()=>[$(g,{style:{width:"100%"},modelValue:o.addEsCfgForm.header,"onUpdate:modelValue":l[7]||(l[7]=e=>o.addEsCfgForm.header=e)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["model"])])),_:1},8,["modelValue","title"]),$(b,{size:"80%",modelValue:o.dialogEditCfgVisible,"onUpdate:modelValue":l[19]||(l[19]=e=>o.dialogEditCfgVisible=e),title:e.$t("编辑鉴权配置")},{footer:k((()=>[$(r,{type:"danger",onClick:l[18]||(l[18]=e=>o.dialogEditCfgVisible=!1)},{default:k((()=>[j(T(e.$t("取消")),1)])),_:1}),$(r,{type:"primary",onClick:s.confirmEditEsCfg},{default:k((()=>[j(T(e.$t("确认")),1)])),_:1},8,["onClick"])])),default:k((()=>[$(d,{model:o.editEsCfgForm,"label-width":"200px","label-position":"left"},{default:k((()=>[$(i,{label:e.$t("备注")},{default:k((()=>[$(p,{clearable:"",modelValue:o.editEsCfgForm.remark,"onUpdate:modelValue":l[10]||(l[10]=e=>o.editEsCfgForm.remark=e),placeholder:e.$t("备注")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),$(i,{label:e.$t("用户名")},{default:k((()=>[$(h,{modelValue:o.editEsCfgForm.user,"onUpdate:modelValue":l[11]||(l[11]=e=>o.editEsCfgForm.user=e),clearable:"","fetch-suggestions":s.querySearch,placeholder:e.$t("用户名")},{default:k((({item:e})=>[w("span",null,T(e.value),1)])),_:1},8,["modelValue","fetch-suggestions","placeholder"])])),_:1},8,["label"]),$(i,{label:e.$t("密码")},{default:k((()=>[$(p,{"show-password":"",type:"password",clearable:"",modelValue:o.editEsCfgForm.pwd,"onUpdate:modelValue":l[12]||(l[12]=e=>o.editEsCfgForm.pwd=e),placeholder:e.$t("密码")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),$(i,{label:e.$t("可访问集群成员")},{default:k((()=>[o.dialogEditCfgVisible?(v(),C(m,{key:0,onChange:e.changeShareRoles,modelValue:o.editEsCfgForm.share_roles,"onUpdate:modelValue":l[13]||(l[13]=e=>o.editEsCfgForm.share_roles=e),titles:["全部角色","当前集群角色"],"button-texts":["移除角色","添加角色"],filterable:"","filter-method":s.filterMethod,"filter-placeholder":"请操作角色",data:o.allRoleConfig},null,8,["onChange","modelValue","filter-method","data"])):le("",!0)])),_:1},8,["label"]),$(i,{label:e.$t("root证书")},{default:k((()=>[$(p,{clearable:"",modelValue:o.editEsCfgForm.rootpem,"onUpdate:modelValue":l[14]||(l[14]=e=>o.editEsCfgForm.rootpem=e),type:"textarea",placeholder:e.$t("root证书")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),$(i,{label:e.$t("cert证书")},{default:k((()=>[$(p,{clearable:"",modelValue:o.editEsCfgForm.certpem,"onUpdate:modelValue":l[15]||(l[15]=e=>o.editEsCfgForm.certpem=e),type:"textarea",placeholder:e.$t("cert证书")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),$(i,{label:e.$t("key证书")},{default:k((()=>[$(p,{clearable:"",modelValue:o.editEsCfgForm.keypem,"onUpdate:modelValue":l[16]||(l[16]=e=>o.editEsCfgForm.keypem=e),type:"textarea",placeholder:e.$t("key证书")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),$(i,{label:e.$t("自定义请求头")},{default:k((()=>[$(g,{style:{width:"100%"},modelValue:o.editEsCfgForm.header,"onUpdate:modelValue":l[17]||(l[17]=e=>o.editEsCfgForm.header=e)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["model"])])),_:1},8,["modelValue","title"])])}]]);export{pl as default};
