import{e,h as a,C as s,d as l,b4 as r,aH as t,aW as o,f as n,w as i,l as u,S as m,V as c,g as d,a7 as p,F as g,aY as f,r as h,b3 as v,aJ as w,aK as _,aZ as y,c as b,R as x,a0 as j,o as V,b5 as q,aS as k,aB as U,p as C,aL as E,b6 as R,aO as S,a4 as z,j as L,aU as K,aV as P,a5 as A,a6 as B}from"./index.DMBpWXpT.js";import{E as H,a as I}from"./el-form.DUR-mZNt.js";import{E as M,a as $,b as N,c as O}from"./el-divider.CoJV5nts.js";import{E as J}from"./el-checkbox.8MJHthul.js";import"./el-tooltip.l0sNRNKZ.js";import{E as D}from"./el-popper.Cb3Eus9m.js";import"./el-form-item.l0sNRNKZ.js";import"./el-scrollbar.BJ_tYB1D.js";import{_ as T}from"./index.DBfl569D.js";import{E as Z}from"./el-switch.BvIaL9AI.js";/* empty css               */import{E as F}from"./el-image.DM0ttR5m.js";import"./el-image-viewer.CSeiPfXQ.js";import{E as G}from"./index.qeCV5ckY.js";import{_ as X}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./castArray.arHVDzqw.js";import"./_Uint8Array.BEOPqGcx.js";import"./dropdown.Dka1h-m0.js";import"./refs.BiRbkTK3.js";import"./isEqual.B61-3bNT.js";import"./isUndefined.DgmxjSXK.js";import"./position.CIWFjaHr.js";import"./debounce.l44evi-0.js";const Y={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Q=[s("path",{fill:"currentColor",d:"M224 448a32 32 0 0 0-32 32v384a32 32 0 0 0 32 32h576a32 32 0 0 0 32-32V480a32 32 0 0 0-32-32zm0-64h576a96 96 0 0 1 96 96v384a96 96 0 0 1-96 96H224a96 96 0 0 1-96-96V480a96 96 0 0 1 96-96"},null,-1),s("path",{fill:"currentColor",d:"M512 544a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V576a32 32 0 0 1 32-32m192-160v-64a192 192 0 1 0-384 0v64zM512 64a256 256 0 0 1 256 256v128H256V320A256 256 0 0 1 512 64"},null,-1)];const W={name:"ep-lock",render:function(s,l){return e(),a("svg",Y,[...Q])}},ee={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},ae=[s("path",{fill:"currentColor",d:"M512 512a192 192 0 1 0 0-384a192 192 0 0 0 0 384m0 64a256 256 0 1 1 0-512a256 256 0 0 1 0 512m320 320v-96a96 96 0 0 0-96-96H288a96 96 0 0 0-96 96v96a32 32 0 1 1-64 0v-96a160 160 0 0 1 160-160h448a160 160 0 0 1 160 160v96a32 32 0 1 1-64 0"},null,-1)];const se={name:"ep-user",render:function(s,l){return e(),a("svg",ee,[...ae])}},le=l({__name:"index",props:{size:{type:String,required:!1}},setup(l){const h=[{label:"中文",value:r.ZH_CN},{label:"English",value:r.EN}],v=t(),{locale:w,t:_}=o();function y(e){w.value=e,v.changeLanguage(e),f.success(_("langSelect.message.success"))}return(r,t)=>{const o=T,f=M,w=$,_=N;return e(),n(_,{trigger:"click",onCommand:y},{dropdown:i((()=>[u(w,null,{default:i((()=>[(e(),a(m,null,c(h,(e=>u(f,{key:e.value,disabled:d(v).language===e.value,command:e.value},{default:i((()=>[p(g(e.label),1)])),_:2},1032,["disabled","command"]))),64))])),_:1})])),default:i((()=>[s("div",null,[u(o,{"icon-class":"language",size:l.size},null,8,["size"])])])),_:1})}}}),re={class:"login-container"},te={class:"flex-x-between absolute-lt w-full p-2"},oe={class:"flex-center"},ne={class:"text-2xl font-bold bg-gradient-to-r from-blue-500 to-teal-500 text-transparent bg-clip-text mx-1"},ie={class:"flex-center"},ue={class:"top-bar"},me={class:"login-content"},ce={key:0,class:"login-image"},de={class:"login-box"},pe=(e=>(K("data-v-340dfe3e"),e=e(),P(),e))((()=>s("h2",{class:"text-xl font-medium text-center flex-center relative"}," 登 录 ",-1))),ge={class:"flex-x-between w-full py-1"},fe=["title","href"],he=X(l({__name:"index",setup(l){const r=h(new URL( window.appSubUrl+"/img/logo.BlrjUcG7.png",import.meta.url).href),K=h(new URL( window.appSubUrl+"/img/work_wechat.zTPxZRB-.png",import.meta.url).href),P=h(new URL( window.appSubUrl+"/img/login_bg.BzmVCLXR.png",import.meta.url).href);t();const M=v().width,$=h(!1),N=w(),T=_(),X=E(),{height:Y}=v(),{t:Q}=o(),ee=h(T.theme===y.DARK),ae=h(!0),he=h(!1),ve=h(!1),we=h(),_e=h({username:"",password:""}),ye=b((()=>({username:[{required:!0,trigger:"blur",message:Q("login.message.username.required")}],password:[{required:!0,trigger:"blur",message:Q("login.message.password.required")},{min:5,message:Q("login.message.password.min"),trigger:"blur"}]})));function be(){var e;null==(e=we.value)||e.validate((async e=>{e&&(he.value=!0,N.login(_e.value).then((e=>{if(console.log("res",e),0!=e.code)return void f.error(e.msg);1==$.value?qe(_e.value.username,_e.value.password):localStorage.removeItem("ev-login_info"),q(e.data.token),f.success(e.msg);const{path:a,queryParams:s}=xe();k.push({path:a,query:s})})).catch((()=>{})).finally((()=>{he.value=!1})))}))}function xe(){const e=X.query.redirect??"/",a=new URL(e,window.location.origin),s=a.pathname,l={};return a.searchParams.forEach(((e,a)=>{"code"!=a&&"state"!=a&&(l[a]=e)})),{path:s,queryParams:l}}const je=()=>{const e=T.theme===y.DARK?y.LIGHT:y.DARK;T.changeTheme(e)};function Ve(e){e instanceof KeyboardEvent&&(ve.value=e.getModifierState("CapsLock"))}x((()=>{Y.value<600?ae.value=!1:ae.value=!0}));const qe=(e,a)=>{let s={username:e,password:a};console.log(s,e,a),localStorage.setItem("ev-login_info",JSON.stringify(s))},ke=()=>{const e=window.location.href;return`${new URL(e).origin}`},Ue=j({oauthConfigs:[]});return V((async()=>{if((async()=>{const e=await R({call_back:ke()});0==e.code&&(null==e.data&&(e.data=[]),Ue.oauthConfigs=e.data)})(),X.query.hasOwnProperty("code")&&X.query.hasOwnProperty("state")){let e=X.query.code,a=X.query.state;N.login({oauth_code:e,state:a}).then((e=>{if(console.log("res",e),0!=e.code)return void f.error(e.msg);q(e.data.token),f.success(e.msg);const{path:a,queryParams:s}=xe();k.push({path:a,query:s})})).catch((()=>{})).finally((()=>{he.value=!1}))}(()=>{let e=localStorage.getItem("ev-login_info");if(null!=e){let a=JSON.parse(e);a.username&&(_e.value.username=a.username),a.password&&(_e.value.password=a.password),$.value=!0}})()})),(l,t)=>{const o=F,f=G,h=Z,v=le,w=se,_=A,y=I,b=W,x=D,j=B,V=J,q=O,k=H;return e(),a("div",re,[s("div",te,[s("div",oe,[u(o,{src:d(r),style:{width:"30px",height:"30px"}},null,8,["src"]),s("span",ne,g(d(S).title),1),u(f,{type:"success"},{default:i((()=>[p("V"+g(window.appVersion),1)])),_:1})]),s("div",ie,[s("div",ue,[u(h,{modelValue:d(ee),"onUpdate:modelValue":t[0]||(t[0]=e=>U(ee)?ee.value=e:null),"inline-prompt":"","active-icon":"Moon","inactive-icon":"Sunny",onChange:je},null,8,["modelValue"]),u(v,{class:"ml-2 cursor-pointer"})])])]),s("div",me,[d(M)>992?(e(),a("div",ce,[u(o,{src:d(P)},null,8,["src"])])):C("",!0),s("div",de,[pe,u(k,{ref_key:"loginFormRef",ref:we,model:d(_e),rules:d(ye),class:"login-form"},{default:i((()=>[u(y,{prop:"username"},{default:i((()=>[u(_,{ref:"username",modelValue:d(_e).username,"onUpdate:modelValue":t[1]||(t[1]=e=>d(_e).username=e),placeholder:l.$t("用户名"),name:"username",size:"large",class:"h-[48px] input-with-select"},{prepend:i((()=>[u(w,{class:"mx-2"})])),_:1},8,["modelValue","placeholder"])])),_:1}),u(x,{visible:d(ve),content:l.$t("大写锁定已打开"),placement:"right"},{default:i((()=>[u(y,{prop:"password"},{default:i((()=>[u(_,{modelValue:d(_e).password,"onUpdate:modelValue":t[2]||(t[2]=e=>d(_e).password=e),placeholder:l.$t("密码"),type:"password",name:"password",onKeyup:[Ve,z(be,["enter"])],size:"large",class:"h-[48px] pr-2 input-with-select","show-password":""},{prepend:i((()=>[u(b,{class:"mx-2"})])),_:1},8,["modelValue","placeholder"])])),_:1})])),_:1},8,["visible","content"]),u(j,{loading:d(he),type:"primary",size:"large",class:"w-full",onClick:L(be,["prevent"])},{default:i((()=>[p(g(l.$t("登录")),1)])),_:1},8,["loading"]),s("div",ge,[u(V,{modelValue:d($),"onUpdate:modelValue":t[3]||(t[3]=e=>U($)?$.value=e:null),class:"rememberme"},{default:i((()=>[p(" 记住密码 ")])),_:1},8,["modelValue"])]),u(q,null,{default:i((()=>[p(" 其他登录方式 ")])),_:1}),u(y,{style:{border:"none"}},{default:i((()=>[s("span",null,[(e(!0),a(m,null,c(d(Ue).oauthConfigs,((s,l)=>(e(),a(m,null,[s.enable?(e(),a("a",{key:0,title:s.name,href:s.oauthUrl},["work_wechat"==s.img?(e(),n(o,{key:0,alt:s.name,src:d(K),class:"provider-img"},null,8,["alt","src"])):C("",!0)],8,fe)):C("",!0)],64)))),256))])])),_:1})])),_:1},8,["model","rules"])])])])}}}),[["__scopeId","data-v-340dfe3e"]]);export{he as default};
