{"version":3,"file":"role.DGl3N_e7.js","sources":["../../../vue/src/views/permission/role.vue","../../../vue/src/api/role.ts"],"sourcesContent":["<template>\n  <div class=\"app-container\">\n\n    <div class=\"search-container\" :class=\"{ 'is-collapsed': isCollapsed && isMobile }\">\n      <div class=\"search-header\" v-if=\"isMobile\" @click=\"toggleCollapse\">\n        <span>搜索条件</span>\n        <el-icon :class=\"{ 'is-collapsed': isCollapsed }\">\n          <ArrowDown />\n        </el-icon>\n      </div>\n      <el-form :inline=\"true\">\n        <el-form-item label=\"角色名:\" prop=\"keywords\">\n          <el-input clearable v-model=\"searchCfg.role_name\" style=\"width:160px\"></el-input>\n        </el-form-item>\n        <el-form-item class=\"button-group\">\n          <el-button\n            type=\"success\"\n            class=\"filter-item\"\n            @click=\"GetRoles(1)\"\n          >\n            {{ $t('搜索') }}\n          </el-button>\n          <el-button\n            type=\"warning\"\n            class=\"filter-item\"\n            @click=\"handleAddRole\"\n          >\n            {{ $t('新增') }}\n          </el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n    <el-card shadow=\"never\" class=\"table-container\">\n      <el-table\n      v-loading=\"_this.loading\"\n      :data=\"_this.rolesList\"\n      @row-dblclick=\"handleEdit\"\n    >\n      <el-table-column align=\"center\" :label=\"$t('id')\" width=\"40\">\n        <template #default=\"scope\">\n          {{ scope.row.id }}\n        </template>\n      </el-table-column>\n      <el-table-column align=\"center\" :label=\"$t('角色名')\" width=\"200\">\n        <template #default=\"scope\">\n          {{ scope.row.name }}\n        </template>\n      </el-table-column>\n      <el-table-column align=\"header-center\" :label=\"$t('备注')\">\n        <template #default=\"scope\">\n          {{ scope.row.description }}\n        </template>\n      </el-table-column>\n      <el-table-column align=\"center\" :label=\"$t('操作')\" width=\"140\" fixed=\"right\">\n        <template #default=\"scope\">\n          <el-button\n            type=\"primary\"\n            @click.stop=\"handleEdit(scope.row)\"\n            :icon=\"Edit\"\n          >\n          </el-button>\n          <el-button\n            type=\"danger\"\n            @click.stop=\"handleDelete(scope)\"\n            :icon=\"Delete\"\n          >\n          </el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    </el-card>\n    <div class=\"pagination-container\">\n      <el-pagination\n        background\n        :current-page=\"input.page\"\n        :page-size=\"input.limit\"\n        :total=\"count\"\n        @current-change=\"GetRoles\"\n        @size-change=\"handleSizeChange\"\n      />\n    </div>\n\n    <el-drawer\n      :size=\"isMobile?'100%':'70%'\"\n      v-model=\"_this.dialogVisible\"\n      :title=\"_this.dialogType==='edit'?$t('修改角色'): $t('新建角色')\"\n    >\n      <el-tabs v-model=\"activeTab\">\n        <!-- 基本信息 Tab -->\n        <el-tab-pane :label=\"$t('基本信息')\" name=\"basic\">\n          <el-form :model=\"_this.role\" label-width=\"80px\" label-position=\"left\">\n            <el-form-item :label=\"$t('角色名')\">\n              <el-input v-model=\"_this.role.name\" :placeholder=\"$t('角色名')\" />\n            </el-form-item>\n            <el-form-item :label=\"$t('备注')\">\n              <el-input\n                v-model=\"_this.role.description\"\n                :autosize=\"{ minRows: 2, maxRows: 4}\"\n                type=\"textarea\"\n                :placeholder=\"$t('备注')\"\n              />\n            </el-form-item>\n          </el-form>\n        </el-tab-pane>\n\n        <!-- 菜单权限 Tab -->\n        <el-tab-pane\n          :label=\"$t('菜单权限')\"\n          name=\"menu\"\n          v-if=\"_this.role.id != 1\"\n        >\n          <div class=\"permission-header\">\n            <el-input\n              v-model=\"_this.filterText\"\n              :placeholder=\"$t('输入关键字进行过滤')\"\n              class=\"filter-input\"\n            />\n            <el-button @click=\"selectAll\">{{ $t('全选') }}</el-button>\n          </div>\n          <el-tree\n            default-expand-all\n            check-on-click-node\n            ref=\"menu_tree\"\n            :filter-node-method=\"filterNode\"\n            :check-strictly=\"_this.checkStrictly\"\n            :data=\"_this.routes\"\n            :props=\"_this.defaultProps\"\n            show-checkbox\n            node-key=\"path\"\n            class=\"permission-tree\"\n          />\n        </el-tab-pane>\n\n        <!-- 接口权限 Tab -->\n        <el-tab-pane\n          :label=\"$t('接口权限')\"\n          name=\"api\"\n          v-if=\"_this.role.id != 1\"\n        >\n          <div class=\"permission-header\">\n            <el-input\n              v-model=\"_this.filterText4Api\"\n              :placeholder=\"$t('输入关键字进行过滤')\"\n              class=\"filter-input\"\n            />\n            <el-button @click=\"selectAll4Api\">{{ $t('全选') }}</el-button>\n          </div>\n          <el-tree\n            default-expand-all\n            check-on-click-node\n            ref=\"api_tree\"\n            :filter-node-method=\"filterNode4Api\"\n            :check-strictly=\"_this.checkStrictly\"\n            :data=\"_this.apiCfg\"\n            :props=\"_this.defaultProps4Api\"\n            show-checkbox\n            node-key=\"value\"\n            class=\"permission-tree\"\n          />\n        </el-tab-pane>\n      </el-tabs>\n\n      <template #footer>\n        <div class=\"drawer-footer\">\n          <el-button type=\"danger\" @click=\"_this.dialogVisible=false\">\n            {{ $t('取消') }}\n          </el-button>\n          <el-button type=\"primary\" @click=\"confirmRole\">\n            {{ $t('确定') }}\n          </el-button>\n        </div>\n      </template>\n    </el-drawer>\n\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport path from 'path-browserify'\n\nimport { deepClone } from '@/utils'\nimport { asyncRoutes } from '@/utils/asyncRoutes'\nimport { addRole, deleteRole, getRoles, updateRole } from '@/api/role'\nimport { UrlConfig } from '@/api/api-rbac'\nimport {GetRoutesConfig} from \"@/api/user\";\nimport {Plus,Search,Edit,Delete,ArrowDown} from \"@element-plus/icons-vue\";\nimport {useAppStore} from \"@/store\";\nimport {DeviceEnum} from \"@/enums/DeviceEnum\";\n\nconst appStore = useAppStore()\n\nconst isMobile = computed(() => appStore.device === DeviceEnum.MOBILE);\n\nconst count = ref(0)\n\nconst handleSizeChange = (v) => {\n  input.limit = v\n  GetRoles(1)\n}\n\nconst defaultRole = {\n  id: '',\n  name: '',\n  description: '',\n  routes: [],\n  api: []\n}\n\nconst searchCfg = reactive({\n  role_name:\"\",\n})\n\nconst _this = reactive({\n\n  asyncRoutes,\n  allAsyncRoutes:[],\n  editLinkRoleId:0,\n  loading:false,\n  allApiConfig: [],\n  value: [],\n  filterMethod(query, item) {\n    return item.label.indexOf(query) > -1\n  },\n  urlConfig: [],\n  urlConfigMap: [],\n  filterText: '',\n  filterText4Api: '',\n  role: Object.assign({}, defaultRole),\n  routes: [],\n  rolesList: [],\n  dialogVisible: false,\n  esLinkDialogVisible:false,\n  dialogType: 'new',\n  checkStrictly: false,\n  defaultProps: {\n    children: 'children',\n    label: 'title'\n  },\n  defaultProps4Api: {\n    children: 'options',\n    label: 'label'\n  },\n  chanCfgList: [],\n  apiCfg:[],\n  selectAllApiCfg:[],\n  apiMap:{},\n  data: [],\n})\n\nconst menu_tree = ref()\nconst api_tree = ref()\n\nwatch(_this.filterText, (val) => {\n  menu_tree.value.filter(val)\n});\n\nwatch(_this.filterText4Api, (val) => {\n  api_tree.value.filter(val)\n});\n\nonMounted(async ()=>{\n  await GetUrlOpt()\n  GetRoutes()\n  GetRoles(1)\n})\n\n//获取接口权限配置\nconst  GetUrlOpt = async () => {\n  let res = await UrlConfig({need_auth:true})\n\n  if (res.code == 0) {\n    let cfg_with_module = JSON.parse(JSON.stringify(res.data.cfg_with_module))\n    let i = cfg_with_module.length;\n    while(i--) {\n      let router = cfg_with_module[i]\n      let j = router.options.length;\n      let options = router.options\n      while(j--) {\n        if(!options[j].needAuth){\n          options.splice(j, 1);\n        }\n        if(options.length == 0){\n          cfg_with_module.splice(i,1)\n        }\n      }\n    }\n    _this.apiMap = {}\n    _this.selectAllApiCfg = []\n    for(let group of cfg_with_module){\n\n      for(let router of group.options){\n        _this.selectAllApiCfg.push(router)\n        _this.apiMap[router[\"value\"]] = router\n      }\n    }\n\n    _this.apiCfg = cfg_with_module\n\n  }\n\n}\n//菜单权限全选\nconst selectAll= () => {\n  menu_tree.value.setCheckedNodes(_this.routes)\n}\nconst selectAll4Api = () => {\n  api_tree.value.setCheckedNodes(_this.selectAllApiCfg)\n}\n\nconst GetRoutes = async () =>{\n\n  let res = await GetRoutesConfig({\n    \"routers\":asyncRoutes,\n  })\n\n  _this.allAsyncRoutes = res.data\n\n  var routers = res.data\n  _this.routes = generateRoutes(routers)\n}\n\nconst onlyOneShowingChildFn = (children = [], parent) => {\n  let onlyOneChild = null\n  const showingChildren = children.filter(item => !item.hidden)\n\n  if (showingChildren.length === 1) {\n    onlyOneChild = showingChildren[0]\n    onlyOneChild.path =  path.resolve(parent.path, onlyOneChild.path)\n    return onlyOneChild\n  }\n\n  if (showingChildren.length === 0) {\n    onlyOneChild = { ...parent, path: '', noShowingChildren: true }\n    return onlyOneChild\n  }\n\n  return false\n}\n\nconst generateRoutes = (routes, basePath = '/')=> {\n  const res = []\n\n  for (let route of routes) {\n\n    if (route.hidden && !route.service) {\n      continue\n    }\n\n    const onlyOneShowingChild = onlyOneShowingChildFn(route.children, route)\n\n    if (route.children && route.children.length > 0  && onlyOneShowingChild && !route.alwaysShow) {\n      route = onlyOneShowingChild\n    }\n\n    const data = {\n      path: path.resolve(basePath, route.path),\n      title: route.meta && route.meta.title\n    }\n\n    if (route.children && route.children.length >0 ) {\n      data.children = generateRoutes(route.children, data.path)\n    }\n    res.push(data)\n  }\n  return res\n}\n//配置tree所需要的配置\nconst generateArr = (routes) => {\n  let data = []\n  routes.forEach(route => {\n    data.push(route)\n    if (route.children && route.children.length >0 ) {\n      const temp = generateArr(route.children)\n      if (temp.length > 0) {\n        data = [...data, ...temp]\n      }\n    }\n  })\n  return data\n}\n//生成菜单\nconst generateTree = (routes, basePath = '/', checkedKeys) => {\n  const res = []\n  for (const route of routes) {\n    if (route.children && route.children.length >0 ) {\n      route.children = generateTree(route.children, path.resolve(basePath, route.path), checkedKeys)\n    }\n\n    if (checkedKeys.includes(path.resolve(basePath, route.path)) || (route.children && route.children.length >= 1)) {\n      res.push(route)\n    }\n  }\n  return res\n}\nconst filterNode = (value, data) => {\n  if (!value) return true\n  return data.title.indexOf(value) !== -1\n}\nconst filterNode4Api = (value, data) => {\n  if (!value) return true\n  return data.label.indexOf(value) !== -1\n}\nconst handleAddRole = () => {\n  _this.role = Object.assign({}, defaultRole)\n  if (menu_tree.value) {\n    menu_tree.value.setCheckedNodes([])\n  }\n  if (api_tree.value) {\n    api_tree.value.setCheckedNodes([])\n  }\n  _this.dialogType = 'new'\n  _this.dialogVisible = true\n}\nconst handleEdit = (row) => {\n  _this.dialogType = 'edit'\n  _this.dialogVisible = true\n  _this.checkStrictly = true\n  _this.role = deepClone(row)\n\n  nextTick(() => {\n    const routes = generateRoutes(_this.role.routes)\n\n    menu_tree.value.setCheckedNodes(generateArr(routes))\n    //todo...\n    let apiList = []\n    for(let v of _this.role.api){\n      apiList.push(_this.apiMap[v])\n    }\n    if(api_tree.value){\n      api_tree.value.setCheckedNodes(apiList)\n    }\n\n    _this.checkStrictly = false\n  })\n}\n\nconst input =reactive({\n  page:1,\n  limit:10,\n})\n\nconst GetRoles = async (page) => {\n  !page ? input.page = 1 : input.page = page\n  _this.loading=true\n  const res = await getRoles({\n    role_name:searchCfg.role_name,\n    page:page,\n    page_size:input.limit\n  })\n  _this.loading=false\n\n  for (var k in res.data.list) {\n    res.data.list[k]['routes'] = JSON.parse(res.data.list[k]['routes'])\n  }\n  count.value = res.data.count\n  _this.rolesList = res.data.list\n}\nconst handleDelete = ({ $index, row }) => {\n  ElMessageBox.confirm('确定删除这个角色吗?', '警告', {\n    confirmButtonText: '确定',\n    cancelButtonText: '取消',\n    type: 'warning'\n  })\n    .then(async() => {\n      let res = await deleteRole({ id: row.id })\n      if (res.code != 0) {\n        ElMessage.error({\n          type: 'error',offset:60,\n          message: res.msg\n        })\n        return\n      }\n      await GetRoles(1)\n      if (res.code != 0) {\n        ElMessage.error({\n          type: 'error',offset:60,\n          message: res.msg\n        })\n        return\n      }\n      ElMessage.success({\n        type: 'success',offset:60,\n        message: res.msg\n      })\n      return\n\n    })\n    .catch(err => {\n      console.error(err)\n    })\n}\n\nconst confirmRole = async () => {\n  if (api_tree.value){\n    const checkedKeys4Api = api_tree.value.getCheckedNodes(true,false)\n    let api = []\n\n    for(let v of checkedKeys4Api){\n      api.push(v.value)\n    }\n\n    _this.role.api = api\n  }\n\n  const isEdit = _this.dialogType === 'edit'\n  const checkedKeys = menu_tree.value.getCheckedKeys()\n  _this.role.routes = generateTree(deepClone(_this.allAsyncRoutes), '/', checkedKeys)\n  var roleModel = _this.role\n  if (roleModel.name.trim() == ''){\n    ElMessage.error({\n      type: 'error',offset:60,\n      message: \"角色名不能为空\"\n    })\n    return\n  }\n  roleModel.routes = JSON.stringify(roleModel.routes)\n  if (isEdit) {\n    roleModel['id'] = _this.role.id\n    let res = await updateRole(roleModel)\n    if (res.code != 0) {\n      ElMessage.error({\n        type: 'error',offset:60,\n        message: res.msg\n      })\n      return\n    }\n    GetRoles(1)\n  } else {\n    roleModel.id = 0\n    const res = await addRole(roleModel)\n    if (res.code != 0) {\n      ElMessage.error({\n        type: 'error',offset:60,\n        message: res.msg\n      })\n      return\n    }\n    GetRoles(1)\n  }\n  _this.dialogVisible = false\n  ElMessage.success({\n    type: 'success',offset:60,\n    message: \"操作成功\"\n  })\n}\n\n// 添加 activeTab 响应式变量\nconst activeTab = ref('basic')\n\n// 添加折叠状态控制\nconst isCollapsed = ref(true)\n\n// 切换折叠状态\nconst toggleCollapse = () => {\n  isCollapsed.value = !isCollapsed.value\n}\n\n</script>\n\n<style>\n.el-transfer-panel {\n  width: 400px;\n  height: 600px;\n}\n\n.el-transfer-panel__list.is-filterable {\n  height: 500px;\n}\n\n</style>\n\n<style lang=\"scss\" scoped>\n.app-container {\n  // 搜索区域样式\n  .search-container {\n    margin-bottom: 1.5rem;\n    padding: 1rem;\n    backdrop-filter: blur(8px);\n    border-radius: 0.5rem;\n    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n    transition: all 0.3s;\n\n    :deep(.el-form) {\n      display: flex;\n      flex-wrap: wrap;\n      align-items: center;\n      gap: 1rem;\n\n      .el-form-item {\n        margin-bottom: 0;\n        margin-right: 0;\n\n        &__label {\n          font-weight: 500;\n        }\n      }\n\n      .el-input {\n        .el-input__wrapper {\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n          border: 1px solid #e5e7eb;\n          transition: all 0.3s;\n\n          &:hover {\n            border-color: #60a5fa;\n          }\n\n          &.is-focus {\n            border-color: #3b82f6;\n            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);\n          }\n        }\n      }\n\n      .el-button {\n        padding: 8px 16px;\n        transition: all 0.3s;\n\n        &:hover {\n          transform: translateY(-1px);\n          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n        }\n\n        &.filter-item {\n          min-width: 80px;\n        }\n      }\n    }\n\n    // 添加移动端折叠相关样式\n    .search-header {\n      display: none; // 默认隐藏\n    }\n\n    @media (max-width: 768px) {\n      .search-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding: 0.5rem 1rem;\n        cursor: pointer;\n        user-select: none;\n\n        span {\n          font-weight: 500;\n        }\n\n        .el-icon {\n          transition: transform 0.3s ease;\n\n          &.is-collapsed {\n            transform: rotate(-180deg);\n          }\n        }\n      }\n\n      &.is-collapsed {\n        :deep(.el-form) {\n          display: none;\n        }\n      }\n\n      :deep(.el-form) {\n        animation: slideDown 0.3s ease;\n\n        .el-form-item {\n          margin-right: 0;\n          width: 100%;\n\n          .el-input {\n            width: 100% !important;\n          }\n\n          // 按钮组样式\n          &.button-group {\n            display: flex;\n            gap: 0.5rem;\n            margin-top: 0.5rem;\n\n            .el-button {\n              flex: 1;\n              margin: 0 !important;\n              width: auto;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  // 表格容器样式\n  .table-container {\n    border-radius: 0.5rem;\n    overflow: hidden;\n    backdrop-filter: blur(8px);\n    transition: all 0.3s;\n    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n\n    :deep(.el-table) {\n      background-color: transparent;\n\n      // 表格行样式\n      .el-table__row {\n        transition: all 0.3s;\n\n        &:hover {\n          transform: translateY(-1px);\n          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n        }\n      }\n\n      // 表头样式\n      th {\n        font-weight: 500;\n        border-bottom: 1px solid #e5e7eb;\n        padding: 12px 0;\n\n        .cell {\n          font-size: 0.95rem;\n        }\n      }\n\n      // 单元格样式\n      td {\n        border-bottom: 1px solid #f3f4f6;\n        padding: 16px 0;\n\n        .cell {\n          line-height: 1.6;\n        }\n      }\n\n      // 操作按钮样式\n      .el-button {\n        padding: 6px 12px;\n        transition: all 0.3s;\n        border-radius: 6px;\n\n        &:not(:last-child) {\n          margin-right: 8px;\n        }\n\n        &:hover {\n          transform: translateY(-1px);\n          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n        }\n\n        &.el-button--primary {\n          background: linear-gradient(135deg, #60a5fa, #3b82f6);\n          border: none;\n\n          &:hover {\n            background: linear-gradient(135deg, #3b82f6, #2563eb);\n          }\n        }\n\n        &.el-button--danger {\n          background: linear-gradient(135deg, #f87171, #ef4444);\n          border: none;\n\n          &:hover {\n            background: linear-gradient(135deg, #ef4444, #dc2626);\n          }\n        }\n      }\n    }\n  }\n\n  // 分页容器样式\n  .pagination-container {\n    margin-top: 1rem;\n    display: flex;\n    justify-content: flex-end;\n\n    :deep(.el-pagination) {\n      padding: 0.75rem;\n      border-radius: 0.5rem;\n      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n\n      .el-pager li {\n        border-radius: 4px;\n        transition: all 0.3s;\n\n        &.is-active {\n          background-color: #3b82f6;\n        }\n      }\n    }\n  }\n\n  // 抽屉内容样式\n  :deep(.el-drawer__body) {\n    padding: 0;\n    display: flex;\n    flex-direction: column;\n\n    .el-tabs {\n      flex: 1;\n      display: flex;\n      flex-direction: column;\n\n      .el-tabs__header {\n        margin: 0;\n        padding: 0 20px;\n        border-bottom: 1px solid #e5e7eb;\n\n        .el-tabs__nav-wrap {\n          &::after {\n            display: none;\n          }\n\n          .el-tabs__nav {\n            border: none;\n          }\n\n          .el-tabs__item {\n            height: 48px;\n            line-height: 48px;\n            padding: 0 24px;\n            font-size: 14px;\n            transition: all 0.3s;\n\n            &.is-active {\n              font-weight: 500;\n            }\n          }\n        }\n      }\n\n      .el-tabs__content {\n        flex: 1;\n        padding: 20px;\n        overflow-y: auto;\n      }\n    }\n\n    // 权限树样式\n    .permission-tree {\n      border: 1px solid #e5e7eb;\n      border-radius: 6px;\n      padding: 12px;\n      margin-top: 12px;\n\n      .el-tree-node__content {\n        height: 36px;\n        transition: all 0.3s;\n      }\n\n      .el-checkbox__input {\n        .el-checkbox__inner {\n          border-radius: 4px;\n        }\n      }\n    }\n  }\n\n  .permission-header {\n    display: flex;\n    gap: 12px;\n    margin-bottom: 16px;\n    align-items: center;\n\n    .filter-input {\n      width: 300px;\n    }\n  }\n\n  .drawer-footer {\n    padding: 16px 20px;\n    border-top: 1px solid #e5e7eb;\n    display: flex;\n    justify-content: flex-end;\n    gap: 12px;\n  }\n}\n\n@keyframes slideDown {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n// 深色模式\n@media (prefers-color-scheme: dark) {\n  .app-container {\n    .search-container {\n      background-color: rgba(31, 41, 55, 0.9);\n\n      .search-header {\n        color: #e5e7eb;\n      }\n    }\n\n    .table-container {\n      background-color: rgba(31, 41, 55, 0.9);\n    }\n\n    :deep(.el-drawer__body) {\n      background-color: #1f2937;\n\n      .el-tabs {\n        .el-tabs__header {\n          border-bottom-color: #374151;\n        }\n      }\n\n      .permission-tree {\n        border-color: #4b5563;\n        background-color: rgba(55, 65, 81, 0.3);\n\n        .el-tree-node__content:hover {\n          background-color: rgba(75, 85, 99, 0.3);\n        }\n      }\n    }\n\n    .drawer-footer {\n      border-top-color: #4b5563;\n      background-color: #1f2937;\n    }\n  }\n}\n</style>\n","import request from \"@/utils/request\";\n\nexport function getRoles(data) {\n  return request({\n    url: '/api/gm_user/roles',\n    method: 'post',\n    data\n  })\n}\n\nexport function addRole(data) {\n  return request({\n    url: '/api/gm_user/role/add',\n    method: 'post',\n    data\n  })\n}\n\nexport function updateRole(data) {\n  return request({\n    url: `/api/gm_user/role/update`,\n    method: 'post',\n    data\n  })\n}\n\nexport function deleteRole(data) {\n\n  return request({\n    url: `/api/gm_user/role/delete`,\n    method: 'post',\n    data\n  })\n}\n"],"names":["appStore","useAppStore","isMobile","computed","device","DeviceEnum","MOBILE","count","ref","handleSizeChange","v","input","limit","GetRoles","defaultRole","id","name","description","routes","api","searchCfg","reactive","role_name","_this","asyncRoutes","allAsyncRoutes","editLinkRoleId","loading","allApiConfig","value","filterMethod","query","item","label","indexOf","urlConfig","urlConfigMap","filterText","filterText4Api","role","Object","assign","rolesList","dialogVisible","esLinkDialogVisible","dialogType","checkStrictly","defaultProps","children","defaultProps4Api","chanCfgList","apiCfg","selectAllApiCfg","apiMap","data","menu_tree","api_tree","watch","val","filter","onMounted","async","GetUrlOpt","res","UrlConfig","need_auth","code","cfg_with_module","JSON","parse","stringify","i","length","router","j","options","needAuth","splice","group","push","selectAll","setCheckedNodes","selectAll4Api","GetRoutes","GetRoutesConfig","routers","generateRoutes","onlyOneShowingChildFn","parent","onlyOneChild","showingChildren","hidden","path","resolve","noShowingChildren","basePath","route","service","onlyOneShowingChild","alwaysShow","title","meta","generateArr","forEach","temp","generateTree","checkedKeys","includes","filterNode","filterNode4Api","handleAddRole","handleEdit","row","deepClone","nextTick","apiList","page","page_size","request","url","method","k","list","handleDelete","$index","ElMessageBox","confirm","confirmButtonText","cancelButtonText","type","then","ElMessage","success","offset","message","msg","error","catch","err","console","confirmRole","checkedKeys4Api","getCheckedNodes","isEdit","getCheckedKeys","roleModel","trim","addRole","activeTab","isCollapsed","toggleCollapse"],"mappings":"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"}